<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åŒ–ç²§å“è²©å£²ç®¡ç†ã‚¢ãƒ—ãƒª</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Noto Sans JP', 'Hiragino Sans', 'Meiryo', sans-serif;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    // ============================================
    // åŒ–ç²§å“è²©å£²ç®¡ç†ã‚¢ãƒ—ãƒª
    // ä¼šè¨ˆå¹´åº¦: 3æœˆã€œç¿Œ2æœˆ
    // ============================================

    const { useState, useEffect, useRef } = React;

    // è£½å“ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿
    const PRODUCT_MASTER = {
      skincare: {
        name: 'ã‚¹ã‚­ãƒ³ã‚±ã‚¢',
        taxRate: 10,
        products: [
          { code: '421628', name: 'ã‚¢ãƒ«ã‚½ã‚¢ã‚¯ã‚¤ãƒ¼ãƒ³ã‚·ãƒ«ãƒãƒ¼(135g)', price: 4000, category: 'QS' },
          { code: '421636', name: 'ã‚¢ãƒ«ã‚½ã‚¢ã‚¯ã‚¤ãƒ¼ãƒ³ã‚·ãƒ«ãƒãƒ¼(70g)', price: 2200, category: 'QS' },
          { code: '421644', name: 'ã‚¢ãƒ«ã‚½ã‚¢ã‚¯ã‚¤ãƒ¼ãƒ³ã‚·ãƒ«ãƒãƒ¼PF(70g)', price: 2200, category: 'QS' },
          { code: '421652', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¯ãƒ¬ã‚¤ãƒ‘ãƒƒã‚¯', price: 3500, category: 'P' },
          { code: '421660', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³I', price: 3500, category: 'L' },
          { code: '421678', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³II', price: 3500, category: 'L' },
          { code: '421686', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚»ãƒ«ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³', price: 4800, category: 'L' },
          { code: '430265', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¨ãƒƒã‚»ãƒ³ã‚¹I', price: 5000, category: 'ES' },
          { code: '421701', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¨ãƒƒã‚»ãƒ³ã‚¹II', price: 8000, category: 'ES' },
          { code: '430273', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚»ãƒ«ã‚¨ãƒƒã‚»ãƒ³ã‚¹', price: 13000, category: 'ES' },
          { code: '421727', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ¢ã‚¤ã‚¹ãƒˆãƒ™ã‚¤ã‚¹', price: 4500, category: 'other' },
          { code: '430281', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚»ãƒ«ã‚»ãƒ©ãƒ ', price: 8000, category: 'other' },
          { code: '446775', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¨ã‚¹', price: 5000, category: 'other' },
          { code: '421751', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚»ãƒ«ã‚¸ã‚§ãƒ«', price: 7000, category: 'other' },
          { code: '421769', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¨ãƒƒã‚»ãƒ³ã‚¹ãƒã‚¹ã‚¯', price: 7500, category: 'other' },
          { code: '421777', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ¢ã‚¤ã‚¹ãƒãƒ¥ã‚¢ãƒ¼ã‚¸ã‚§ãƒ«', price: 3800, category: 'other' },
          { code: '419540', name: 'ã‚¢ãƒ ãƒ‹ãƒ¼AP ã‚½ãƒ¼ãƒ—', price: 3500, category: 'other' },
          { code: '429789', name: 'ã‚¢ãƒ ãƒ‹ãƒ¼AP ã‚¹ã‚­ãƒ³ã‚½ãƒ¼ãƒ—', price: 2000, category: 'other' },
          { code: '386898', name: 'ã‚¢ãƒ ãƒ‹ãƒ¼AP ã‚¹ã‚­ãƒ³ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³', price: 2700, category: 'other' },
          { code: '386905', name: 'ã‚¢ãƒ ãƒ‹ãƒ¼AP ã‚¹ã‚­ãƒ³ã‚³ãƒ¼ãƒˆ', price: 2500, category: 'other' },
        ]
      },
      baseMakeup: {
        name: 'ãƒ™ãƒ¼ã‚¹ãƒ¡ã‚¤ã‚¯ã‚¢ãƒƒãƒ—',
        taxRate: 10,
        products: [
          { code: '441501', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ—ãƒ¬ãƒšã‚¢', price: 4000, category: 'other' },
          { code: '441519', name: 'ãƒªãƒ™ã‚¹ãƒˆSPãƒ—ãƒ¬ãƒšã‚¢', price: 4200, category: 'SP' },
          { code: '441527', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ¢ã‚¤ã‚¹ãƒˆãƒ—ãƒ¬ãƒšã‚¢', price: 4500, category: 'other' },
          { code: '441535', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ”ãƒ³ã‚¯(01)', price: 4000, category: 'other' },
          { code: '441543', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ©ã‚¤ãƒˆ(02)', price: 4000, category: 'other' },
          { code: '441551', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒŠãƒãƒ¥ãƒ©ãƒ«(03)', price: 4000, category: 'other' },
          { code: '441569', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ã‚ªãƒ¼ã‚¯ãƒ«ãƒ©ã‚¤ãƒˆ(04)', price: 4000, category: 'other' },
          { code: '441577', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒŠãƒãƒ¥ãƒ©ãƒ€ãƒ¼ã‚¯(05)', price: 4000, category: 'other' },
          { code: '441585', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒ´ã‚§ãƒ¼ãƒ«ãƒ”ãƒ³ã‚¯ãƒ©ã‚¤ãƒˆ(11)', price: 6000, category: 'other' },
          { code: '441593', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒ´ã‚§ãƒ¼ãƒ«ãƒŠãƒãƒ¥ãƒ©ãƒ«(12)', price: 6000, category: 'other' },
          { code: '441600', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒ´ã‚§ãƒ¼ãƒ«ã‚ªãƒ¼ã‚¯ãƒ«ãƒ©ã‚¤ãƒˆ(13)', price: 6000, category: 'other' },
          { code: '448490', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰F ãƒ´ã‚§ãƒ¼ãƒ«ãƒŠãƒãƒ¥ãƒ©ãƒ€ãƒ¼ã‚¯(14)', price: 6000, category: 'other' },
          { code: '441618', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ãƒ«ã‚­ãƒ¼ãƒ‘ã‚¦ãƒ€ãƒ¼F ãƒ”ãƒ³ã‚¯(21)', price: 5600, category: 'other' },
          { code: '441626', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ãƒ«ã‚­ãƒ¼ãƒ‘ã‚¦ãƒ€ãƒ¼F ãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ©ã‚¤ãƒˆ(22)', price: 5600, category: 'other' },
          { code: '441759', name: 'ãƒ¡ã‚¤ã‚¯ã‚ªãƒ•', price: 3000, category: 'MO' },
        ]
      },
      hairBodyCare: {
        name: 'ãƒ˜ã‚¢ã‚±ã‚¢&ãƒœãƒ‡ã‚£ã‚±ã‚¢',
        taxRate: 10,
        products: [
          { code: '429151', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼', price: 2500, category: 'other' },
          { code: '437250', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ ãƒªãƒ•ã‚£ãƒ«', price: 2000, category: 'other' },
          { code: '429177', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼', price: 2500, category: 'other' },
          { code: '437260', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼ ãƒªãƒ•ã‚£ãƒ«', price: 2000, category: 'other' },
          { code: '429193', name: 'ã‚¢ãƒ«ã‚½ã‚¢ EXã‚·ãƒ£ãƒ³ãƒ—ãƒ¼', price: 2600, category: 'other' },
          { code: '437270', name: 'ã‚¢ãƒ«ã‚½ã‚¢ EXã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ ãƒªãƒ•ã‚£ãƒ«', price: 2200, category: 'other' },
          { code: '429218', name: 'ã‚¢ãƒ«ã‚½ã‚¢ EXãƒˆãƒªãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆ', price: 2800, category: 'other' },
          { code: '429226', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ˜ã‚¢ãƒŸã‚¹ãƒˆ', price: 1800, category: 'other' },
          { code: '429234', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒˆãƒªãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚ªã‚¤ãƒ«', price: 2800, category: 'other' },
          { code: '429242', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¹ã‚«ãƒ«ãƒ—ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³', price: 2700, category: 'other' },
          { code: '429250', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¹ã‚«ãƒ«ãƒ—ã‚¨ãƒƒã‚»ãƒ³ã‚¹', price: 4500, category: 'other' },
          { code: '378952', name: 'ãƒ—ãƒªã‚·ãƒ¼ãƒãƒã‚¹ãƒ‘ã‚¦ãƒ€ãƒ¼', price: 3000, category: 'other' },
          { code: '381997', name: 'ãƒ—ãƒªã‚·ãƒ¼ãƒãƒœãƒ‡ã‚£ã‚½ãƒ¼ãƒ—', price: 2500, category: 'other' },
          { code: '382002', name: 'ãƒ—ãƒªã‚·ãƒ¼ãƒãƒœãƒ‡ã‚£ã‚½ãƒ¼ãƒ— ãƒªãƒ•ã‚£ãƒ«', price: 1700, category: 'other' },
          { code: '421339', name: 'ãƒ—ãƒªã‚·ãƒ¼ãƒãƒœãƒ‡ã‚£ãƒŸã‚¹ãƒˆ', price: 2000, category: 'other' },
          { code: '22814', name: 'ã‚¢ãƒ”ãƒ–ãƒ©ã‚·', price: 3000, category: 'other' },
          { code: '445933', name: 'ã—ã‚‰ãã¬ã®æ¹¯s', price: 3000, category: 'other' },
        ]
      },
      healthcare: {
        name: 'ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢',
        taxRate: 8,
        products: [
          { code: '447731', name: 'ã‚¢ãƒ«ã‚½ã‚¢ é…µç´ ', price: 10000, category: 'é…µç´ ' },
          { code: '447757', name: 'ã‚¢ãƒ«ã‚½ã‚¢ é…µç´ ãƒ—ãƒ©ã‚¹ ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼', price: 5500, category: 'é…µç´ ' },
          { code: '447765', name: 'ã‚¢ãƒ«ã‚½ã‚¢ é…µç´ ãƒ—ãƒ©ã‚¹ ãƒ©ãƒ¼ã‚¸', price: 15000, category: 'é…µç´ ' },
          { code: '447781', name: 'ã‚¢ãƒ«ã‚½ã‚¢ é…µç´ G', price: 20000, category: 'é…µç´ ' },
          { code: '447806', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ç™½é¶´éœŠèŠã‚¨ã‚¯ã‚¹ãƒˆãƒ© 10æœ¬å…¥', price: 12000, category: 'other' },
          { code: '447814', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ç™½é¶´éœŠèŠã‚¨ã‚¯ã‚¹ãƒˆãƒ© 30æœ¬å…¥', price: 32000, category: 'other' },
          { code: '447856', name: 'ã‚¢ãƒ«ã‚½ã‚¢ éœŠèŠ ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼', price: 12000, category: 'other' },
          { code: '447864', name: 'ã‚¢ãƒ«ã‚½ã‚¢ éœŠèŠ ãƒ©ãƒ¼ã‚¸', price: 30000, category: 'other' },
          { code: '448028', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚ªãƒ¡ã‚¬3', price: 9000, category: 'other' },
          { code: '447963', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚·ãƒŠãƒ¤ã‚« ãƒ¬ã‚®ãƒ¥ãƒ©ãƒ¼', price: 9000, category: 'other' },
          { code: '447971', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚·ãƒŠãƒ¤ã‚« ãƒ©ãƒ¼ã‚¸', price: 24000, category: 'other' },
          { code: '447898', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ“ã‚¨ãƒƒã‚»S', price: 10000, category: 'other' },
          { code: '447913', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ“ã‚¨ãƒƒã‚»EX', price: 20000, category: 'other' },
          { code: '448010', name: 'ã‚¢ãƒ«ã‚½ã‚¢ Fe', price: 4000, category: 'other' },
          { code: '448044', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚¯ãƒªã‚¢ãƒ¼', price: 3800, category: 'other' },
          { code: '447830', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ç™½é¶´éœŠèŠAG', price: 12000, category: 'other' },
          { code: '447997', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒŸãƒãƒ©ãƒ«ãƒ—ãƒ©ã‚¹', price: 5800, category: 'other' },
          { code: '447947', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ã‚»ãƒ«ã‚¨ãƒŠã‚¸ã‚£V', price: 10000, category: 'other' },
          { code: '447939', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒªãƒŠã‚«ãƒ³C', price: 5000, category: 'other' },
          { code: '447880', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ãƒ”ãƒ¥ã‚¢ã‚«ãƒ«Ca', price: 6500, category: 'other' },
          { code: '448052', name: 'ã‚¢ãƒ«ã‚½ã‚¢ ç™½é¶´éœŠèŠãƒ†ã‚£ãƒ¼', price: 3800, category: 'other' },
        ]
      },
      pointMakeup: {
        name: 'ãƒã‚¤ãƒ³ãƒˆãƒ¡ã‚¤ã‚¯ã‚¢ãƒƒãƒ—',
        taxRate: 10,
        products: [
          // ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« Â¥1,400
          { code: '441816', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒã‚¶ãƒ¼ã‚·ã‚§ãƒ«(C201)', price: 1400, category: 'è‰²' },
          { code: '441824', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚·ãƒ«ãƒãƒ¼ãƒ ãƒ¼ãƒ³(C202)', price: 1400, category: 'è‰²' },
          { code: '441832', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚«ãƒ¼ãƒ ãƒ–ãƒ©ãƒƒã‚¯(C203)', price: 1400, category: 'è‰²' },
          { code: '441840', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ€ã‚¹ãƒˆ(N204)', price: 1400, category: 'è‰²' },
          { code: '441858', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒˆãƒ¯ã‚¤ãƒ©ã‚¤ãƒˆãƒ™ãƒ¼ã‚¸ãƒ¥(N205)', price: 1400, category: 'è‰²' },
          { code: '441866', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚¸ãƒ£ã‚¹ãƒ‘ãƒ¼ãƒ¬ãƒƒãƒ‰(N206)', price: 1400, category: 'è‰²' },
          { code: '441874', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚µãƒ³ãƒ©ã‚¤ãƒˆ(W207)', price: 1400, category: 'è‰²' },
          { code: '441882', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚ªãƒ¬ãƒ³ã‚¸ãƒŸã‚¹ãƒˆ(W208)', price: 1400, category: 'è‰²' },
          { code: '441890', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒ”ãƒãƒ–ãƒ©ã‚¦ãƒ³(W209)', price: 1400, category: 'è‰²' },
          { code: '441907', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚ªãƒ¼ãƒ­ãƒ©ãƒ–ãƒ«ãƒ¼(C210)', price: 1400, category: 'è‰²' },
          { code: '441915', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚ªãƒ¼ã‚·ãƒ£ãƒ³ãƒ¬ã‚¤(C211)', price: 1400, category: 'è‰²' },
          { code: '441923', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚³ãƒ¢ãƒ¬ãƒ“ã‚¤ã‚¨ãƒ­ãƒ¼(N212)', price: 1400, category: 'è‰²' },
          { code: '441931', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒ­ãƒ¼ã‚ºã‚¯ãƒ©ã‚¦ãƒ‰(N213)', price: 1400, category: 'è‰²' },
          { code: '441949', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒ‡ãƒ¥ãƒ¼ãƒ³ã‚´ãƒ¼ãƒ«ãƒ‰(W214)', price: 1400, category: 'è‰²' },
          { code: '441957', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚·ã‚§ãƒ¼ãƒ‰ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚µãƒãƒ³ãƒŠã‚°ãƒªãƒ¼ãƒ³(W215)', price: 1400, category: 'è‰²' },
          // ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« Â¥1,800
          { code: '441965', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒãƒ”ãƒã‚¹ãƒ”ãƒ³ã‚¯(C401)', price: 1800, category: 'è‰²' },
          { code: '441973', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒ‡ã‚£ãƒ©ã‚¤ãƒˆã‚³ãƒ¼ãƒ©ãƒ«(N402)', price: 1800, category: 'è‰²' },
          { code: '441981', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ãƒã‚¢ãƒ•ãƒ«ã‚ªãƒ¬ãƒ³ã‚¸(W403)', price: 1800, category: 'è‰²' },
          { code: '441999', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ­ãƒ¼ã‚º(C404)', price: 1800, category: 'è‰²' },
          { code: '442004', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚·ãƒ•ã‚©ãƒ³ãƒ›ãƒ¯ã‚¤ãƒˆ(N405)', price: 1800, category: 'è‰²' },
          { code: '442012', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚ªãƒ³ãƒªãƒ•ã‚£ãƒ« ã‚»ãƒ”ã‚¢ãƒ™ãƒ¼ã‚¸ãƒ¥(N406)', price: 1800, category: 'è‰²' },
          // ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« Â¥1,000
          { code: '442020', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ãƒ“ãƒ¼ãƒŠã‚¹ãƒ”ãƒ³ã‚¯(C701)', price: 1000, category: 'è‰²' },
          { code: '442038', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ãƒ‘ãƒ¬ã‚¹ãƒ”ãƒ³ã‚¯(C702)', price: 1000, category: 'è‰²' },
          { code: '442046', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ã‚»ãƒ¼ãƒ–ãƒ«ãƒ­ãƒ¼ã‚º(C703)', price: 1000, category: 'è‰²' },
          { code: '442054', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ã‚°ã‚¢ãƒãƒ”ãƒ³ã‚¯(N704)', price: 1000, category: 'è‰²' },
          { code: '442062', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ã‚ªãƒšãƒ©ãƒ¬ãƒƒãƒ‰(N705)', price: 1000, category: 'è‰²' },
          { code: '442070', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ãƒ¬ãƒƒãƒ‰ãƒªãƒªãƒ¼(N706)', price: 1000, category: 'è‰²' },
          { code: '442088', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ã‚ªãƒ¬ãƒ³ã‚¸ã‚¼ãƒ©ãƒ‹ã‚¦ãƒ (W707)', price: 1000, category: 'è‰²' },
          { code: '442096', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ãƒ”ãƒ¼ãƒãƒ´ã‚§ãƒ¼ãƒ«(W708)', price: 1000, category: 'è‰²' },
          { code: '442103', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ã‚¬ãƒŠãƒƒã‚·ãƒ¥ãƒ–ãƒ©ã‚¦ãƒ³(W709)', price: 1000, category: 'è‰²' },
          { code: '442111', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚«ãƒ©ãƒ¼ãƒªãƒ•ã‚£ãƒ« ãƒã‚¸ãƒƒã‚¯ãƒ†ã‚£ãƒ³ãƒˆ(80)', price: 1000, category: 'è‰²' },
          // ãã®ä»–ãƒã‚¤ãƒ³ãƒˆãƒ¡ã‚¤ã‚¯å•†å“
          { code: '446098', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚³ãƒ¼ãƒˆ', price: 3000, category: 'other' },
          { code: '446080', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªãƒƒãƒ—ã‚°ãƒ­ã‚¹ ã‚·ãƒ£ã‚¤ãƒ‹ãƒ¼ã‚¯ãƒªã‚¢', price: 2300, category: 'other' },
          { code: '446006', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ–ãƒ­ã‚¦ãƒ›ãƒ«ãƒ€ãƒ¼', price: 1700, category: 'other' },
          { code: '445983', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ–ãƒ­ã‚¦ãƒªãƒ•ã‚£ãƒ« ãƒ–ãƒ©ã‚¦ãƒ³(55)', price: 1700, category: 'other' },
          { code: '445991', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ–ãƒ­ã‚¦ãƒªãƒ•ã‚£ãƒ« ã‚°ãƒ¬ãƒ¼(56)', price: 1700, category: 'other' },
          { code: '446048', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ–ãƒ­ã‚¦ãƒ‘ã‚¦ãƒ€ãƒ¼', price: 3800, category: 'other' },
          { code: '446056', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ–ãƒ­ã‚¦ãƒ‘ã‚¦ãƒ€ãƒ¼ ãƒªãƒ•ã‚£ãƒ«', price: 2700, category: 'other' },
          { code: '446030', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ©ã‚¤ãƒŠãƒ¼ãƒ›ãƒ«ãƒ€ãƒ¼', price: 1700, category: 'other' },
          { code: '446014', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ©ã‚¤ãƒŠãƒ¼ãƒªãƒ•ã‚£ãƒ« ãƒ–ãƒ©ã‚¦ãƒ³(50)', price: 1700, category: 'other' },
          { code: '446022', name: 'ãƒªãƒ™ã‚¹ãƒˆã‚¢ã‚¤ãƒ©ã‚¤ãƒŠãƒ¼ãƒªãƒ•ã‚£ãƒ« ã‚°ãƒ¬ãƒ¼(51)', price: 1700, category: 'other' },
          { code: '446064', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒªã‚­ãƒƒãƒ‰ã‚¢ã‚¤ãƒ©ã‚¤ãƒŠãƒ¼ ãƒ–ãƒ©ãƒƒã‚¯', price: 2100, category: 'other' },
          { code: '446072', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ­ãƒ³ã‚°ãƒã‚¹ã‚«ãƒ© ãƒ–ãƒ©ãƒƒã‚¯', price: 3300, category: 'other' },
          { code: '441759', name: 'ãƒªãƒ™ã‚¹ãƒˆãƒ¡ã‚¤ã‚¯ã‚ªãƒ•', price: 3000, category: 'other' },
          { code: '420670', name: 'çœ‰ãƒ–ãƒ©ã‚·ï¼†ã‚³ãƒ¼ãƒ ', price: 500, category: 'other' },
          { code: '448622', name: 'ãƒªãƒƒãƒ—ãƒ–ãƒ©ã‚·', price: 1500, category: 'other' },
        ]
      }
    };

    // è£½å“ã‚«ãƒ†ã‚´ãƒªç•¥ç§°ãƒãƒƒãƒ”ãƒ³ã‚°
    const CATEGORY_ABBREV = {
      'QS': 'ã‚¯ã‚¤ãƒ¼ãƒ³ã‚·ãƒ«ãƒãƒ¼',
      'L': 'ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³',
      'P': 'ãƒ‘ãƒƒã‚¯',
      'ES': 'ã‚¨ãƒƒã‚»ãƒ³ã‚¹',
      'SP': 'SPãƒ—ãƒ¬ãƒšã‚¢',
      'MO': 'ãƒ¡ã‚¤ã‚¯ã‚ªãƒ•',
      'é…µç´ ': 'é…µç´ ',
      'è‰²': 'è‰²',
      'other': 'ãã®ä»–'
    };

    // å…¨è£½å“ãƒªã‚¹ãƒˆã‚’å–å¾—ï¼ˆã‚«ã‚¹ã‚¿ãƒ è£½å“ã‚’å«ã‚€ï¼‰
    const getAllProducts = (customProducts = {}) => {
      const products = [];
      Object.entries(PRODUCT_MASTER).forEach(([key, category]) => {
        // çµ„ã¿è¾¼ã¿è£½å“
        category.products.forEach(product => {
          products.push({
            ...product,
            categoryName: category.name,
            categoryKey: key,
            taxRate: category.taxRate,
            isCustom: false
          });
        });
        // ã‚«ã‚¹ã‚¿ãƒ è£½å“
        if (customProducts[key]) {
          customProducts[key].forEach(product => {
            products.push({
              ...product,
              categoryName: category.name,
              categoryKey: key,
              taxRate: category.taxRate,
              isCustom: true
            });
          });
        }
      });
      return products;
    };

    // è£½å“ã‚³ãƒ¼ãƒ‰ã‹ã‚‰è£½å“ã‚’æ¤œç´¢ï¼ˆã‚«ã‚¹ã‚¿ãƒ è£½å“ã‚’å«ã‚€ï¼‰
    const findProductByCode = (code, customProducts = {}) => {
      return getAllProducts(customProducts).find(p => p.code === code);
    };

    // ä¼šè¨ˆå¹´åº¦ã‚’å–å¾—ï¼ˆ3æœˆã€œç¿Œ2æœˆï¼‰
    const getFiscalYear = (date) => {
      const d = new Date(date);
      const month = d.getMonth() + 1;
      const year = d.getFullYear();
      return month >= 3 ? year : year - 1;
    };

    // ä¼šè¨ˆå¹´åº¦ã®æœˆãƒªã‚¹ãƒˆ
    const FISCAL_MONTHS = [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2];

    // PDFå‡ºåŠ›ç”¨ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
    const printDocument = (content, title, orientation = 'portrait') => {
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <!DOCTYPE html>
        <html lang="ja">
        <head>
          <meta charset="UTF-8">
          <title>${title}</title>
          <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
          <style>
            @page {
              size: A4 ${orientation};
              margin: 15mm;
            }
            * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
            }
            body {
              font-family: 'Noto Sans JP', 'Hiragino Sans', 'Meiryo', sans-serif;
              font-size: 10pt;
              line-height: 1.4;
              color: #333;
            }
            .print-header {
              text-align: center;
              margin-bottom: 15px;
              padding-bottom: 10px;
              border-bottom: 2px solid #333;
            }
            .print-header h1 {
              font-size: 16pt;
              margin-bottom: 5px;
            }
            .print-header .subtitle {
              font-size: 10pt;
              color: #666;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              font-size: 9pt;
            }
            th, td {
              border: 1px solid #333;
              padding: 4px 6px;
              text-align: left;
            }
            th {
              background-color: #f0f0f0;
              font-weight: bold;
            }
            thead {
              display: table-header-group;
            }
            tbody {
              display: table-row-group;
            }
            tr {
              page-break-inside: avoid;
            }
            .section {
              margin-bottom: 20px;
            }
            .section-title {
              font-size: 12pt;
              font-weight: bold;
              margin-bottom: 10px;
              padding: 5px;
              background-color: #f5f5f5;
            }
            .summary-grid {
              display: grid;
              grid-template-columns: repeat(4, 1fr);
              gap: 10px;
              margin-bottom: 20px;
            }
            .summary-item {
              border: 1px solid #ccc;
              padding: 10px;
              text-align: center;
            }
            .summary-item .label {
              font-size: 9pt;
              color: #666;
            }
            .summary-item .value {
              font-size: 14pt;
              font-weight: bold;
            }
            .count-grid {
              display: grid;
              grid-template-columns: repeat(12, 1fr);
              gap: 3px;
            }
            .count-cell {
              border: 1px solid #ccc;
              padding: 3px;
              text-align: center;
              font-size: 7pt;
              min-height: 40px;
            }
            .count-cell.filled {
              background-color: #e8f5e9;
            }
            .count-cell .num {
              font-weight: bold;
              color: #888;
            }
            .count-cell .name {
              font-size: 6pt;
              overflow: hidden;
            }
            .text-right {
              text-align: right;
            }
            .text-center {
              text-align: center;
            }
            @media print {
              body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            }
          </style>
        </head>
        <body>
          ${content}
        </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.onload = () => {
        printWindow.print();
      };
    };

    // ============================================
    // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    // ============================================
    function CosmeticsSalesApp() {
      const [currentView, setCurrentView] = useState('dashboard');
      const [customers, setCustomers] = useState([]);
      const [sales, setSales] = useState([]);
      const [monthlyReports, setMonthlyReports] = useState([]);
      const [customProducts, setCustomProducts] = useState({
        skincare: [],
        baseMakeup: [],
        hairBodyCare: [],
        healthcare: [],
        pointMakeup: []
      });
      const [displayCutoff, setDisplayCutoff] = useState(null); // å±¥æ­´è¡¨ç¤ºã®åŸºæº–æ—¥
      const [notification, setNotification] = useState(null);

      useEffect(() => {
        loadData();
      }, []);

      const loadData = () => {
        try {
          const savedCustomers = localStorage.getItem('cosmetics_customers');
          const savedSales = localStorage.getItem('cosmetics_sales');
          const savedReports = localStorage.getItem('cosmetics_monthly_reports');
          const savedCustomProducts = localStorage.getItem('cosmetics_custom_products');
          const savedDisplayCutoff = localStorage.getItem('cosmetics_display_cutoff');
          
          if (savedCustomers) setCustomers(JSON.parse(savedCustomers));
          if (savedSales) setSales(JSON.parse(savedSales));
          if (savedReports) setMonthlyReports(JSON.parse(savedReports));
          if (savedCustomProducts) setCustomProducts(JSON.parse(savedCustomProducts));
          if (savedDisplayCutoff) setDisplayCutoff(JSON.parse(savedDisplayCutoff));
        } catch (e) {
          console.error('ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', e);
        }
      };

      const saveData = (newCustomers = customers, newSales = sales, newReports = monthlyReports, newCustomProducts = customProducts, newDisplayCutoff = displayCutoff) => {
        try {
          localStorage.setItem('cosmetics_customers', JSON.stringify(newCustomers));
          localStorage.setItem('cosmetics_sales', JSON.stringify(newSales));
          localStorage.setItem('cosmetics_monthly_reports', JSON.stringify(newReports));
          localStorage.setItem('cosmetics_custom_products', JSON.stringify(newCustomProducts));
          localStorage.setItem('cosmetics_display_cutoff', JSON.stringify(newDisplayCutoff));
        } catch (e) {
          console.error('ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ©ãƒ¼:', e);
        }
      };

      const showNotification = (message, type = 'success') => {
        setNotification({ message, type });
        setTimeout(() => setNotification(null), 3000);
      };

      const addCustomer = (customer) => {
        const newCustomers = [...customers, { ...customer, id: Date.now() }];
        setCustomers(newCustomers);
        saveData(newCustomers, sales, monthlyReports);
        showNotification('é¡§å®¢ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
      };

      const updateCustomer = (id, updates) => {
        const newCustomers = customers.map(c => c.id === id ? { ...c, ...updates } : c);
        setCustomers(newCustomers);
        saveData(newCustomers, sales, monthlyReports);
      };

      const deleteCustomer = (id) => {
        const customer = customers.find(c => c.id === id);
        if (confirm(`ã€Œ${customer?.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nâ€»ã“ã®é¡§å®¢ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã¯æ®‹ã‚Šã¾ã™`)) {
          const newCustomers = customers.filter(c => c.id !== id);
          setCustomers(newCustomers);
          saveData(newCustomers, sales, monthlyReports, customProducts);
          showNotification('é¡§å®¢ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        }
      };

      const addCustomProduct = (categoryKey, product) => {
        // å•†å“ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
        const allProducts = getAllProducts(customProducts);
        if (allProducts.some(p => p.code === product.code)) {
          showNotification('ã“ã®å•†å“ã‚³ãƒ¼ãƒ‰ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™', 'error');
          return false;
        }
        
        const newProduct = {
          ...product,
          id: Date.now(),
          isCustom: true
        };
        const newCustomProducts = {
          ...customProducts,
          [categoryKey]: [...(customProducts[categoryKey] || []), newProduct]
        };
        setCustomProducts(newCustomProducts);
        saveData(customers, sales, monthlyReports, newCustomProducts);
        showNotification('è£½å“ã‚’è¿½åŠ ã—ã¾ã—ãŸ');
        return true;
      };

      const deleteCustomProduct = (categoryKey, productId) => {
        const product = customProducts[categoryKey]?.find(p => p.id === productId);
        if (confirm(`ã€Œ${product?.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nâ€»éå»ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“`)) {
          const newCustomProducts = {
            ...customProducts,
            [categoryKey]: customProducts[categoryKey].filter(p => p.id !== productId)
          };
          setCustomProducts(newCustomProducts);
          saveData(customers, sales, monthlyReports, newCustomProducts);
          showNotification('è£½å“ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        }
      };

      const addSale = (sale) => {
        const newSale = {
          ...sale,
          id: Date.now(),
          createdAt: new Date().toISOString()
        };
        const newSales = [...sales, newSale];
        setSales(newSales);
        saveData(customers, newSales, monthlyReports, customProducts, displayCutoff);
        showNotification('å£²ä¸Šã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
      };

      const updateSale = (id, updatedSale) => {
        const newSales = sales.map(s => 
          s.id === id 
            ? { ...s, ...updatedSale, updatedAt: new Date().toISOString() }
            : s
        );
        setSales(newSales);
        saveData(customers, newSales, monthlyReports, customProducts, displayCutoff);
        showNotification('å£²ä¸Šã‚’æ›´æ–°ã—ã¾ã—ãŸ');
      };

      const deleteSale = (id) => {
        const sale = sales.find(s => s.id === id);
        if (confirm(`${sale?.date} ${sale?.customerName}ã®å£²ä¸Šã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nâ€»ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“`)) {
          const newSales = sales.filter(s => s.id !== id);
          setSales(newSales);
          saveData(customers, newSales, monthlyReports, customProducts, displayCutoff);
          showNotification('å£²ä¸Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        }
      };

      const clearSalesHistory = () => {
        if (confirm('å±¥æ­´è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢ã—ã¦ç¿Œæœˆã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿ\n\nâ€»å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“\nâ€»ãƒ¬ãƒãƒ¼ãƒˆé›†è¨ˆã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“')) {
          const newCutoff = new Date().toISOString();
          setDisplayCutoff(newCutoff);
          saveData(customers, sales, monthlyReports, customProducts, newCutoff);
          showNotification('å±¥æ­´è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
        }
      };

      const saveMonthlyReport = (report) => {
        const existingIndex = monthlyReports.findIndex(
          r => r.year === report.year && r.month === report.month
        );
        let newReports;
        if (existingIndex >= 0) {
          newReports = [...monthlyReports];
          newReports[existingIndex] = report;
        } else {
          newReports = [...monthlyReports, report];
        }
        setMonthlyReports(newReports);
        saveData(customers, sales, newReports, customProducts, displayCutoff);
        showNotification('æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸ');
      };

      const exportBackup = () => {
        const data = {
          exportDate: new Date().toISOString(),
          version: '1.3',
          customers,
          sales,
          monthlyReports,
          customProducts,
          displayCutoff
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `cosmetics_backup_${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        showNotification('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
      };

      const importBackup = (file) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const data = JSON.parse(e.target.result);
            if (data.customers) setCustomers(data.customers);
            if (data.sales) setSales(data.sales);
            if (data.monthlyReports) setMonthlyReports(data.monthlyReports);
            if (data.customProducts) setCustomProducts(data.customProducts);
            if (data.displayCutoff) setDisplayCutoff(data.displayCutoff);
            saveData(
              data.customers || [], 
              data.sales || [], 
              data.monthlyReports || [],
              data.customProducts || { skincare: [], baseMakeup: [], hairBodyCare: [], healthcare: [], pointMakeup: [] },
              data.displayCutoff || null
            );
            showNotification('ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å¾©å…ƒã—ã¾ã—ãŸ');
          } catch (err) {
            showNotification('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
          }
        };
        reader.readAsText(file);
      };

      const importCustomersFile = (file) => {
        const reader = new FileReader();
        const isExcel = file.name.endsWith('.xlsx') || file.name.endsWith('.xls');
        
        reader.onload = (e) => {
          try {
            let rows = [];
            
            if (isExcel) {
              // Excelãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†
              const data = new Uint8Array(e.target.result);
              const workbook = XLSX.read(data, { type: 'array' });
              const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
              const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
              rows = jsonData;
            } else {
              // CSVãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†
              const text = e.target.result;
              rows = text.split('\n').filter(line => line.trim()).map(line => line.split(',').map(s => s.trim()));
            }
            
            const newCustomers = [];
            rows.forEach((row, index) => {
              // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆé¡§å®¢åã€åå‰ã€ãƒ©ãƒ³ã‚¯ç­‰ã‚’å«ã‚€å ´åˆï¼‰
              if (index === 0) {
                const firstCell = String(row[0] || '').toLowerCase();
                if (firstCell.includes('é¡§å®¢') || firstCell.includes('åå‰') || firstCell.includes('ãƒ©ãƒ³ã‚¯') || firstCell === 'name') {
                  return;
                }
              }
              
              const name = String(row[0] || '').trim();
              const rank = String(row[1] || 'C').trim().toUpperCase();
              
              if (name && name.length > 0) {
                const existing = customers.find(c => c.name === name);
                if (!existing) {
                  newCustomers.push({
                    id: Date.now() + index,
                    name,
                    rank: ['A', 'B', 'C', 'D'].includes(rank) ? rank : 'C'
                  });
                }
              }
            });
            
            const allCustomers = [...customers, ...newCustomers];
            setCustomers(allCustomers);
            saveData(allCustomers, sales, monthlyReports, customProducts);
            showNotification(`${newCustomers.length}ä»¶ã®é¡§å®¢ã‚’è¿½åŠ ã—ã¾ã—ãŸ`);
          } catch (err) {
            console.error('Import error:', err);
            showNotification('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
          }
        };
        
        if (isExcel) {
          reader.readAsArrayBuffer(file);
        } else {
          reader.readAsText(file);
        }
      };

      const menuItems = [
        { id: 'dashboard', label: 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰', icon: 'ğŸ“Š' },
        { id: 'sales-input', label: 'å£²ä¸Šä¼ç¥¨å…¥åŠ›', icon: 'ğŸ“' },
        { id: 'customer-list', label: 'ãŠå®¢æ§˜åˆ†å¸ƒãƒªã‚¹ãƒˆ', icon: 'ğŸ‘¥' },
        { id: 'product-count', label: 'è£½å“åˆ¥è²©å£²ç©ç®—', icon: 'ğŸ“ˆ' },
        { id: 'monthly-report', label: 'æœˆæœ«ãƒ¬ãƒãƒ¼ãƒˆ', icon: 'ğŸ“‹' },
        { id: 'yearly-report', label: 'å¹´é–“ABCå ±å‘Š', icon: 'ğŸ“…' },
        { id: 'master', label: 'ãƒã‚¹ã‚¿ç®¡ç†', icon: 'âš™ï¸' },
        { id: 'backup', label: 'ãƒ‡ãƒ¼ã‚¿ç®¡ç†', icon: 'ğŸ’¾' },
      ];

      return (
        <div style={styles.container}>
          <aside style={styles.sidebar}>
            <div style={styles.logo}>
              <span style={styles.logoIcon}>ğŸ’„</span>
              <span style={styles.logoText}>è²©å£²ç®¡ç†</span>
            </div>
            <nav style={styles.nav}>
              {menuItems.map(item => (
                <button
                  key={item.id}
                  onClick={() => setCurrentView(item.id)}
                  style={{
                    ...styles.navItem,
                    ...(currentView === item.id ? styles.navItemActive : {})
                  }}
                >
                  <span style={styles.navIcon}>{item.icon}</span>
                  <span style={styles.navLabel}>{item.label}</span>
                </button>
              ))}
            </nav>
            <div style={styles.fiscalYear}>
              ä¼šè¨ˆå¹´åº¦: {getFiscalYear(new Date())}å¹´åº¦
              <br />
              <small>({getFiscalYear(new Date())}å¹´3æœˆã€œ{getFiscalYear(new Date()) + 1}å¹´2æœˆ)</small>
            </div>
          </aside>

          <main style={styles.main}>
            {notification && (
              <div style={{
                ...styles.notification,
                backgroundColor: notification.type === 'error' ? '#fee2e2' : '#dcfce7',
                color: notification.type === 'error' ? '#dc2626' : '#16a34a'
              }}>
                {notification.message}
              </div>
            )}

            {currentView === 'dashboard' && (
              <Dashboard 
                customers={customers}
                sales={sales}
                monthlyReports={monthlyReports}
              />
            )}
            {currentView === 'sales-input' && (
              <SalesInput 
                customers={customers}
                sales={sales}
                addSale={addSale}
                updateSale={updateSale}
                deleteSale={deleteSale}
                addCustomer={addCustomer}
                customProducts={customProducts}
                displayCutoff={displayCutoff}
                clearSalesHistory={clearSalesHistory}
              />
            )}
            {currentView === 'customer-list' && (
              <CustomerList 
                customers={customers}
                sales={sales}
                updateCustomer={updateCustomer}
              />
            )}
            {currentView === 'product-count' && (
              <ProductCount sales={sales} />
            )}
            {currentView === 'monthly-report' && (
              <MonthlyReport 
                customers={customers}
                sales={sales}
                monthlyReports={monthlyReports}
                saveMonthlyReport={saveMonthlyReport}
              />
            )}
            {currentView === 'yearly-report' && (
              <YearlyReport 
                monthlyReports={monthlyReports}
                customers={customers}
                sales={sales}
              />
            )}
            {currentView === 'master' && (
              <MasterManagement 
                customers={customers}
                addCustomer={addCustomer}
                updateCustomer={updateCustomer}
                deleteCustomer={deleteCustomer}
                importCustomersFile={importCustomersFile}
                customProducts={customProducts}
                addCustomProduct={addCustomProduct}
                deleteCustomProduct={deleteCustomProduct}
              />
            )}
            {currentView === 'backup' && (
              <BackupManagement 
                exportBackup={exportBackup}
                importBackup={importBackup}
              />
            )}
          </main>
        </div>
      );
    }

    // ============================================
    // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    // ============================================
    function Dashboard({ customers, sales, monthlyReports }) {
      const currentDate = new Date();
      const currentMonth = currentDate.getMonth() + 1;
      const currentYear = currentDate.getFullYear();
      const fiscalYear = getFiscalYear(currentDate);

      const currentMonthSales = sales.filter(s => {
        const d = new Date(s.date);
        return d.getMonth() + 1 === currentMonth && d.getFullYear() === currentYear;
      });

      const totalSalesAmount = currentMonthSales.reduce((sum, s) => 
        sum + s.items.reduce((itemSum, item) => itemSum + (item.price * item.quantity), 0), 0
      );

      const fiscalYearSales = sales.filter(s => getFiscalYear(new Date(s.date)) === fiscalYear);
      
      let qsCount = 0;
      let lotionCount = 0;
      
      fiscalYearSales.forEach(sale => {
        sale.items.forEach(item => {
          if (item.category === 'QS') qsCount += item.quantity;
          if (item.category === 'L') lotionCount += item.quantity;
        });
      });

      const rankCounts = { A: 0, B: 0, C: 0, D: 0 };
      customers.forEach(c => {
        if (rankCounts[c.rank] !== undefined) rankCounts[c.rank]++;
      });

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
          
          <div style={styles.cardGrid}>
            <div style={styles.card}>
              <div style={styles.cardHeader}>
                <span style={styles.cardIcon}>ğŸ’°</span>
                <span>ä»Šæœˆã®å£²ä¸Š</span>
              </div>
              <div style={styles.cardValue}>
                Â¥{totalSalesAmount.toLocaleString()}
              </div>
              <div style={styles.cardSub}>
                {currentMonthSales.length}ä»¶ã®å–å¼•
              </div>
            </div>

            <div style={styles.card}>
              <div style={styles.cardHeader}>
                <span style={styles.cardIcon}>ğŸ‘¥</span>
                <span>ç·é¡§å®¢æ•°</span>
              </div>
              <div style={styles.cardValue}>
                {customers.length}å
              </div>
              <div style={styles.cardSub}>
                A:{rankCounts.A} B:{rankCounts.B} C:{rankCounts.C} D:{rankCounts.D}
              </div>
            </div>

            <div style={styles.card}>
              <div style={styles.cardHeader}>
                <span style={styles.cardIcon}>ğŸ§¼</span>
                <span>QSï¼ˆå¹´é–“ç›®æ¨™120å€‹ï¼‰</span>
              </div>
              <div style={styles.cardValue}>
                {qsCount} / 120
              </div>
              <div style={styles.progressBar}>
                <div style={{
                  ...styles.progressFill,
                  width: `${Math.min(100, (qsCount / 120) * 100)}%`
                }}></div>
              </div>
              <div style={styles.cardSub}>
                é”æˆç‡: {Math.round((qsCount / 120) * 100)}%
              </div>
            </div>

            <div style={styles.card}>
              <div style={styles.cardHeader}>
                <span style={styles.cardIcon}>ğŸ’§</span>
                <span>ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå¹´é–“ç›®æ¨™210å€‹ï¼‰</span>
              </div>
              <div style={styles.cardValue}>
                {lotionCount} / 210
              </div>
              <div style={styles.progressBar}>
                <div style={{
                  ...styles.progressFill,
                  width: `${Math.min(100, (lotionCount / 210) * 100)}%`,
                  backgroundColor: '#3b82f6'
                }}></div>
              </div>
              <div style={styles.cardSub}>
                é”æˆç‡: {Math.round((lotionCount / 210) * 100)}%
              </div>
            </div>
          </div>

          <div style={styles.section}>
            <h2 style={styles.sectionTitle}>æœ€è¿‘ã®å£²ä¸Šï¼ˆç›´è¿‘5ä»¶ï¼‰</h2>
            <div style={styles.tableContainer}>
              <table style={styles.table}>
                <thead>
                  <tr>
                    <th style={styles.th}>æ—¥ä»˜</th>
                    <th style={styles.th}>é¡§å®¢å</th>
                    <th style={styles.th}>å•†å“</th>
                    <th style={styles.th}>é‡‘é¡</th>
                  </tr>
                </thead>
                <tbody>
                  {sales.slice(-5).reverse().map(sale => (
                    <tr key={sale.id}>
                      <td style={styles.td}>{sale.date}</td>
                      <td style={styles.td}>{sale.customerName}</td>
                      <td style={styles.td}>
                        {sale.items.map(item => item.name).join(', ')}
                      </td>
                      <td style={styles.td}>
                        Â¥{sale.items.reduce((sum, item) => sum + (item.price * item.quantity), 0).toLocaleString()}
                      </td>
                    </tr>
                  ))}
                  {sales.length === 0 && (
                    <tr>
                      <td colSpan="4" style={{ ...styles.td, textAlign: 'center', color: '#999' }}>
                        å£²ä¸Šãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“
                      </td>
                    </tr>
                  )}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // å£²ä¸Šä¼ç¥¨å…¥åŠ›
    // ============================================
    function SalesInput({ customers, sales, addSale, updateSale, deleteSale, addCustomer, customProducts, displayCutoff, clearSalesHistory }) {
      const [step, setStep] = useState(1);
      const [uploadedImage, setUploadedImage] = useState(null);
      const [isProcessing, setIsProcessing] = useState(false);
      const [editMode, setEditMode] = useState(false);
      const [editingSaleId, setEditingSaleId] = useState(null);
      const [formData, setFormData] = useState({
        date: new Date().toISOString().split('T')[0],
        customerName: '',
        items: [{ name: '', quantity: 1, price: 0, code: '', category: 'other' }]
      });
      const [newCustomerMode, setNewCustomerMode] = useState(false);
      const [newCustomerRank, setNewCustomerRank] = useState('C');

      const fileInputRef = useRef(null);

      // è¡¨ç¤ºå¯¾è±¡ã®å£²ä¸Šå±¥æ­´ã‚’å–å¾—
      const getDisplaySales = () => {
        if (!displayCutoff) {
          return sales.slice().sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
        }
        return sales
          .filter(s => new Date(s.createdAt) >= new Date(displayCutoff))
          .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
      };

      const displaySales = getDisplaySales();

      const handleImageUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            setUploadedImage(e.target.result);
            processImage(e.target.result);
          };
          reader.readAsDataURL(file);
        }
      };

      const processImage = async (imageData) => {
        setIsProcessing(true);
        setTimeout(() => {
          setIsProcessing(false);
          setStep(2);
        }, 1500);
      };

      const handleProductSelect = (index, productCode) => {
        const product = findProductByCode(productCode, customProducts);
        if (product) {
          const newItems = [...formData.items];
          newItems[index] = {
            ...newItems[index],
            name: product.name,
            code: product.code,
            price: product.price,
            category: product.category
          };
          setFormData({ ...formData, items: newItems });
        }
      };

      const addItem = () => {
        setFormData({
          ...formData,
          items: [...formData.items, { name: '', quantity: 1, price: 0, code: '', category: 'other' }]
        });
      };

      const removeItem = (index) => {
        const newItems = formData.items.filter((_, i) => i !== index);
        setFormData({ ...formData, items: newItems.length ? newItems : [{ name: '', quantity: 1, price: 0, code: '', category: 'other' }] });
      };

      const calculateTotal = () => {
        return formData.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      };

      const handleSubmit = () => {
        if (!formData.customerName) {
          alert('é¡§å®¢åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          return;
        }
        if (formData.items.every(item => !item.name)) {
          alert('å•†å“ã‚’1ã¤ä»¥ä¸Šå…¥åŠ›ã—ã¦ãã ã•ã„');
          return;
        }

        if (newCustomerMode) {
          const existingCustomer = customers.find(c => c.name === formData.customerName);
          if (!existingCustomer) {
            addCustomer({ name: formData.customerName, rank: newCustomerRank });
          }
        }

        if (editMode && editingSaleId) {
          // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰: æ—¢å­˜å£²ä¸Šã‚’æ›´æ–°
          updateSale(editingSaleId, {
            date: formData.date,
            customerName: formData.customerName,
            items: formData.items.filter(item => item.name)
          });
        } else {
          // æ–°è¦ç™»éŒ²
          addSale({
            date: formData.date,
            customerName: formData.customerName,
            items: formData.items.filter(item => item.name)
          });
        }

        setStep(3);
      };

      const resetForm = () => {
        setStep(1);
        setUploadedImage(null);
        setEditMode(false);
        setEditingSaleId(null);
        setFormData({
          date: new Date().toISOString().split('T')[0],
          customerName: '',
          items: [{ name: '', quantity: 1, price: 0, code: '', category: 'other' }]
        });
        setNewCustomerMode(false);
      };

      const handleEditSale = (sale) => {
        setEditMode(true);
        setEditingSaleId(sale.id);
        setFormData({
          date: sale.date,
          customerName: sale.customerName,
          items: sale.items.length > 0 ? sale.items : [{ name: '', quantity: 1, price: 0, code: '', category: 'other' }]
        });
        setNewCustomerMode(false);
        setStep(2);
      };

      const formatDate = (dateStr) => {
        const d = new Date(dateStr);
        return `${d.getMonth() + 1}/${d.getDate()}`;
      };

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>
            å£²ä¸Šä¼ç¥¨å…¥åŠ›
            {editMode && <span style={styles.editModeBadge}>ç·¨é›†ãƒ¢ãƒ¼ãƒ‰</span>}
          </h1>

          <div style={styles.stepIndicator}>
            <div style={{...styles.step, ...(step >= 1 ? styles.stepActive : {})}}>
              <span style={styles.stepNumber}>1</span>
              <span>ä¼ç¥¨ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
            </div>
            <div style={styles.stepLine}></div>
            <div style={{...styles.step, ...(step >= 2 ? styles.stepActive : {})}}>
              <span style={styles.stepNumber}>2</span>
              <span>ç¢ºèªãƒ»ä¿®æ­£</span>
            </div>
            <div style={styles.stepLine}></div>
            <div style={{...styles.step, ...(step >= 3 ? styles.stepActive : {})}}>
              <span style={styles.stepNumber}>3</span>
              <span>å®Œäº†</span>
            </div>
          </div>

          {step === 1 && (
            <div style={styles.uploadSection}>
              <div 
                style={styles.uploadArea}
                onClick={() => fileInputRef.current?.click()}
              >
                {isProcessing ? (
                  <div style={styles.processing}>
                    <div style={styles.spinner}></div>
                    <p>ç”»åƒã‚’èª­ã¿å–ã‚Šä¸­...</p>
                  </div>
                ) : (
                  <>
                    <div style={styles.uploadIcon}>ğŸ“·</div>
                    <p style={styles.uploadText}>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä¼ç¥¨ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
                    <p style={styles.uploadSubtext}>ã¾ãŸã¯ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
                  </>
                )}
              </div>
              <input
                ref={fileInputRef}
                type="file"
                accept="image/*"
                onChange={handleImageUpload}
                style={{ display: 'none' }}
              />
              
              <div style={styles.orDivider}>
                <span>ã¾ãŸã¯</span>
              </div>
              
              <button 
                style={styles.manualButton}
                onClick={() => setStep(2)}
              >
                æ‰‹å‹•å…¥åŠ›ã§ç™»éŒ²ã™ã‚‹
              </button>
            </div>
          )}

          {step === 2 && (
            <div style={styles.formSection}>
              {editMode && (
                <div style={styles.editModeHeader}>
                  <span>ğŸ“ å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’ç·¨é›†ä¸­ï¼ˆID: {editingSaleId}ï¼‰</span>
                </div>
              )}
              <div style={{...styles.formGrid, gridTemplateColumns: uploadedImage ? '1fr 1fr' : '1fr'}}>
                {uploadedImage && (
                  <div style={styles.imagePreview}>
                    <h3 style={styles.previewTitle}>ä¼ç¥¨ç”»åƒ</h3>
                    <img src={uploadedImage} alt="ä¼ç¥¨" style={styles.previewImage} />
                  </div>
                )}
                
                <div style={styles.formPanel}>
                  <h3 style={styles.formTitle}>{editMode ? 'å£²ä¸Šãƒ‡ãƒ¼ã‚¿ç·¨é›†' : 'ä¼ç¥¨å†…å®¹'}</h3>
                  
                  <div style={styles.formGroup}>
                    <label style={styles.label}>æ—¥ä»˜</label>
                    <input
                      type="date"
                      value={formData.date}
                      onChange={(e) => setFormData({...formData, date: e.target.value})}
                      style={styles.input}
                    />
                  </div>

                  <div style={styles.formGroup}>
                    <label style={styles.label}>é¡§å®¢å</label>
                    <div style={styles.customerInputGroup}>
                      <input
                        type="text"
                        list="customer-list"
                        value={formData.customerName}
                        onChange={(e) => {
                          setFormData({...formData, customerName: e.target.value});
                          const existing = customers.find(c => c.name === e.target.value);
                          setNewCustomerMode(!existing && e.target.value.length > 0);
                        }}
                        placeholder="é¡§å®¢åã‚’å…¥åŠ›"
                        style={styles.input}
                      />
                      <datalist id="customer-list">
                        {customers.map(c => (
                          <option key={c.id} value={c.name} />
                        ))}
                      </datalist>
                    </div>
                    {newCustomerMode && (
                      <div style={styles.newCustomerNote}>
                        <span style={styles.newBadge}>æ–°è¦é¡§å®¢</span>
                        <select 
                          value={newCustomerRank}
                          onChange={(e) => setNewCustomerRank(e.target.value)}
                          style={styles.rankSelect}
                        >
                          <option value="A">Aãƒ©ãƒ³ã‚¯</option>
                          <option value="B">Bãƒ©ãƒ³ã‚¯</option>
                          <option value="C">Cãƒ©ãƒ³ã‚¯</option>
                          <option value="D">Dãƒ©ãƒ³ã‚¯</option>
                        </select>
                      </div>
                    )}
                  </div>

                  <div style={styles.formGroup}>
                    <label style={styles.label}>å•†å“æ˜ç´°</label>
                    {formData.items.map((item, index) => (
                      <div key={index} style={styles.itemRow}>
                        <select
                          value={item.code}
                          onChange={(e) => handleProductSelect(index, e.target.value)}
                          style={styles.productSelect}
                        >
                          <option value="">å•†å“ã‚’é¸æŠ...</option>
                          {Object.entries(PRODUCT_MASTER).map(([key, category]) => {
                            const builtInProducts = category.products;
                            const customProds = customProducts[key] || [];
                            const allProducts = [...builtInProducts, ...customProds];
                            
                            return (
                              <optgroup key={key} label={category.name}>
                                {allProducts.map(product => (
                                  <option key={product.code + (product.isCustom ? '_c' : '')} value={product.code}>
                                    {product.isCustom ? 'â˜… ' : ''}{product.name} (Â¥{product.price.toLocaleString()})
                                  </option>
                                ))}
                              </optgroup>
                            );
                          })}
                        </select>
                        <input
                          type="number"
                          min="1"
                          value={item.quantity}
                          onChange={(e) => {
                            const newItems = [...formData.items];
                            newItems[index].quantity = parseInt(e.target.value) || 1;
                            setFormData({...formData, items: newItems});
                          }}
                          style={styles.quantityInput}
                        />
                        <span style={styles.itemPrice}>
                          Â¥{(item.price * item.quantity).toLocaleString()}
                        </span>
                        <button
                          onClick={() => removeItem(index)}
                          style={styles.removeButton}
                        >
                          âœ•
                        </button>
                      </div>
                    ))}
                    <button onClick={addItem} style={styles.addItemButton}>
                      ï¼‹ å•†å“ã‚’è¿½åŠ 
                    </button>
                  </div>

                  <div style={styles.totalSection}>
                    <span>åˆè¨ˆé‡‘é¡ï¼ˆç¨æŠœï¼‰</span>
                    <span style={styles.totalAmount}>Â¥{calculateTotal().toLocaleString()}</span>
                  </div>

                  <div style={styles.buttonGroup}>
                    <button onClick={resetForm} style={styles.cancelButton}>
                      ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                    </button>
                    <button onClick={handleSubmit} style={styles.submitButton}>
                      {editMode ? 'æ›´æ–°ã™ã‚‹' : 'ç™»éŒ²ã™ã‚‹'}
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {step === 3 && (
            <div style={styles.completionSection}>
              <div style={styles.completionIcon}>âœ…</div>
              <h2 style={styles.completionTitle}>{editMode ? 'æ›´æ–°å®Œäº†' : 'ç™»éŒ²å®Œäº†'}</h2>
              <p style={styles.completionText}>
                {editMode ? 'å£²ä¸Šãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚' : 'å£²ä¸Šä¼ç¥¨ãŒç™»éŒ²ã•ã‚Œã¾ã—ãŸã€‚'}<br />
                ãŠå®¢æ§˜åˆ†å¸ƒãƒªã‚¹ãƒˆãƒ»è£½å“åˆ¥è²©å£²ç©ç®—è¡¨ã«åæ˜ ã•ã‚Œã¦ã„ã¾ã™ã€‚
              </p>
              <button onClick={resetForm} style={styles.submitButton}>
                ç¶šã‘ã¦å…¥åŠ›ã™ã‚‹
              </button>
            </div>
          )}

          {/* å£²ä¸Šå±¥æ­´ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
          <div style={styles.historySection}>
            <div style={styles.historyHeader}>
              <h2 style={styles.historySectionTitle}>ğŸ“‹ ç›´è¿‘ã®å£²ä¸Šå±¥æ­´</h2>
              <span style={styles.historyCount}>
                è¡¨ç¤ºä»¶æ•°: {displaySales.length}ä»¶
                {displayCutoff && ` ï¼ˆ${new Date(displayCutoff).toLocaleDateString('ja-JP')}ä»¥é™ï¼‰`}
              </span>
            </div>
            
            {displaySales.length > 0 ? (
              <div style={styles.tableContainer}>
                <table style={styles.table}>
                  <thead>
                    <tr>
                      <th style={styles.th}>æ—¥ä»˜</th>
                      <th style={styles.th}>é¡§å®¢å</th>
                      <th style={styles.th}>å•†å“</th>
                      <th style={styles.th}>é‡‘é¡</th>
                      <th style={{...styles.th, width: 100}}>æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody>
                    {displaySales.map(sale => (
                      <tr key={sale.id} style={editingSaleId === sale.id ? styles.editingRow : {}}>
                        <td style={styles.td}>{formatDate(sale.date)}</td>
                        <td style={styles.td}>{sale.customerName}</td>
                        <td style={{...styles.td, maxWidth: 250, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap'}}>
                          {sale.items.map((item, i) => (
                            <span key={i}>
                              {i > 0 && ', '}
                              {item.name}{item.quantity > 1 ? `Ã—${item.quantity}` : ''}
                            </span>
                          ))}
                        </td>
                        <td style={styles.td}>
                          Â¥{sale.items.reduce((sum, item) => sum + (item.price * item.quantity), 0).toLocaleString()}
                        </td>
                        <td style={styles.td}>
                          <div style={styles.actionButtons}>
                            <button 
                              onClick={() => handleEditSale(sale)}
                              style={styles.editButton}
                              title="ç·¨é›†"
                            >
                              âœï¸
                            </button>
                            <button 
                              onClick={() => deleteSale(sale.id)}
                              style={styles.deleteButtonSmall}
                              title="å‰Šé™¤"
                            >
                              ğŸ—‘ï¸
                            </button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            ) : (
              <div style={styles.noHistory}>
                <p>å±¥æ­´ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>
              </div>
            )}

            {/* ç¿Œæœˆæ›´æ–°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
            <div style={styles.monthEndSection}>
              <div style={styles.monthEndWarning}>
                <h4>âš ï¸ æœˆæœ«å‡¦ç†</h4>
                <p>ç¿Œæœˆã®å…¥åŠ›ã‚’å§‹ã‚ã‚‹å‰ã«ã€Œç¿Œæœˆæ›´æ–°ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„</p>
                <p style={styles.monthEndNote}>â€»å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“ã€‚å±¥æ­´è¡¨ç¤ºã®ã¿ã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™</p>
              </div>
              <button onClick={clearSalesHistory} style={styles.clearHistoryButton}>
                ğŸ”„ ç¿Œæœˆæ›´æ–°ï¼ˆå±¥æ­´ã‚’ã‚¯ãƒªã‚¢ï¼‰
              </button>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // ãŠå®¢æ§˜åˆ†å¸ƒãƒªã‚¹ãƒˆï¼ˆæ›¸é¡2ï¼‰
    // ============================================
    function CustomerList({ customers, sales, updateCustomer }) {
      const [selectedYear, setSelectedYear] = useState(getFiscalYear(new Date()));
      const [searchTerm, setSearchTerm] = useState('');

      const getCustomerSales = (customerName) => {
        const customerSales = sales.filter(s => 
          s.customerName === customerName && 
          getFiscalYear(new Date(s.date)) === selectedYear
        );

        const monthlyPurchases = {};
        FISCAL_MONTHS.forEach(m => monthlyPurchases[m] = []);

        const categoryCounts = { QS: 0, L: 0, P: 0, ES: 0, other: 0 };
        let totalAmount = 0;

        customerSales.forEach(sale => {
          const month = new Date(sale.date).getMonth() + 1;
          sale.items.forEach(item => {
            if (monthlyPurchases[month]) {
              const abbrev = item.category || 'other';
              monthlyPurchases[month].push(abbrev);
            }
            if (categoryCounts[item.category] !== undefined) {
              categoryCounts[item.category] += item.quantity;
            } else {
              categoryCounts.other += item.quantity;
            }
            totalAmount += item.price * item.quantity;
          });
        });

        return {
          monthlyPurchases,
          categoryCounts,
          totalAmount,
          monthlyAverage: customerSales.length > 0 ? Math.round(totalAmount / 12) : 0
        };
      };

      const filteredCustomers = customers.filter(c => 
        c.name.includes(searchTerm) || c.rank.includes(searchTerm)
      );

      const handlePrint = () => {
        const rows = filteredCustomers.map((customer, index) => {
          const salesData = getCustomerSales(customer.name);
          return `
            <tr>
              <td class="text-center">${index + 1}</td>
              <td class="text-center">${customer.rank}</td>
              <td>${customer.name}</td>
              <td class="text-right">Â¥${salesData.totalAmount.toLocaleString()}</td>
              <td class="text-right">Â¥${salesData.monthlyAverage.toLocaleString()}</td>
              <td class="text-center">${salesData.categoryCounts.QS || '-'}</td>
              <td class="text-center">${salesData.categoryCounts.L || '-'}</td>
              <td class="text-center">${salesData.categoryCounts.P || '-'}</td>
              <td class="text-center">${salesData.categoryCounts.ES || '-'}</td>
              ${FISCAL_MONTHS.map(month => 
                `<td class="text-center" style="font-size:7pt;">${salesData.monthlyPurchases[month]?.join(',') || '-'}</td>`
              ).join('')}
            </tr>
          `;
        }).join('');

        const content = `
          <div class="print-header">
            <h1>ãŠå®¢æ§˜åˆ†å¸ƒãƒªã‚¹ãƒˆï¼ˆæ›¸é¡2ï¼‰</h1>
            <div class="subtitle">${selectedYear}å¹´åº¦ï¼ˆ${selectedYear}å¹´3æœˆã€œ${selectedYear + 1}å¹´2æœˆï¼‰ã€€å‡ºåŠ›æ—¥: ${new Date().toLocaleDateString('ja-JP')}</div>
          </div>
          <table>
            <thead>
              <tr>
                <th style="width:30px;">No</th>
                <th style="width:35px;">ãƒ©ãƒ³ã‚¯</th>
                <th style="min-width:80px;">ãŠå®¢æ§˜å</th>
                <th style="width:80px;">å¹´é–“è³¼å…¥</th>
                <th style="width:65px;">æœˆå¹³å‡</th>
                <th style="width:30px;">QS</th>
                <th style="width:30px;">L</th>
                <th style="width:30px;">P</th>
                <th style="width:30px;">ES</th>
                ${FISCAL_MONTHS.map(m => `<th style="width:45px;">${m}æœˆ</th>`).join('')}
              </tr>
            </thead>
            <tbody>
              ${rows}
            </tbody>
          </table>
        `;
        printDocument(content, 'ãŠå®¢æ§˜åˆ†å¸ƒãƒªã‚¹ãƒˆ', 'landscape');
      };

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>ãŠå®¢æ§˜åˆ†å¸ƒãƒªã‚¹ãƒˆï¼ˆæ›¸é¡2ï¼‰</h1>

          <div style={styles.filterBar}>
            <div style={styles.filterGroup}>
              <label>å¹´åº¦:</label>
              <select 
                value={selectedYear} 
                onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                style={styles.filterSelect}
              >
                {[2024, 2025, 2026, 2027].map(year => (
                  <option key={year} value={year}>{year}å¹´åº¦</option>
                ))}
              </select>
            </div>
            <div style={styles.filterGroup}>
              <input
                type="text"
                placeholder="é¡§å®¢åãƒ»ãƒ©ãƒ³ã‚¯ã§æ¤œç´¢..."
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
                style={styles.searchInput}
              />
            </div>
            <button onClick={handlePrint} style={styles.printButton}>
              ğŸ“„ PDFå‡ºåŠ›ï¼ˆæ¨ªï¼‰
            </button>
          </div>

          <div style={styles.wideTableContainer}>
            <table style={styles.table}>
              <thead>
                <tr>
                  <th style={{...styles.th, position: 'sticky', left: 0, backgroundColor: '#f8f9fa', zIndex: 1}}>No</th>
                  <th style={{...styles.th, position: 'sticky', left: 40, backgroundColor: '#f8f9fa', zIndex: 1}}>ãƒ©ãƒ³ã‚¯</th>
                  <th style={{...styles.th, position: 'sticky', left: 90, backgroundColor: '#f8f9fa', zIndex: 1, minWidth: 100}}>ãŠå®¢æ§˜å</th>
                  <th style={styles.th}>å¹´é–“è³¼å…¥é‡‘é¡</th>
                  <th style={styles.th}>æœˆå¹³å‡</th>
                  <th style={styles.th}>QS</th>
                  <th style={styles.th}>L</th>
                  <th style={styles.th}>P</th>
                  <th style={styles.th}>ES</th>
                  {FISCAL_MONTHS.map(month => (
                    <th key={month} style={styles.th}>{month}æœˆ</th>
                  ))}
                </tr>
              </thead>
              <tbody>
                {filteredCustomers.map((customer, index) => {
                  const salesData = getCustomerSales(customer.name);
                  return (
                    <tr key={customer.id}>
                      <td style={{...styles.td, position: 'sticky', left: 0, backgroundColor: '#fff', zIndex: 1}}>{index + 1}</td>
                      <td style={{...styles.td, position: 'sticky', left: 40, backgroundColor: '#fff', zIndex: 1}}>
                        <select
                          value={customer.rank}
                          onChange={(e) => updateCustomer(customer.id, { rank: e.target.value })}
                          style={styles.inlineSelect}
                        >
                          <option value="A">A</option>
                          <option value="B">B</option>
                          <option value="C">C</option>
                          <option value="D">D</option>
                        </select>
                      </td>
                      <td style={{...styles.td, position: 'sticky', left: 90, backgroundColor: '#fff', zIndex: 1}}>{customer.name}</td>
                      <td style={styles.td}>Â¥{salesData.totalAmount.toLocaleString()}</td>
                      <td style={styles.td}>Â¥{salesData.monthlyAverage.toLocaleString()}</td>
                      <td style={styles.td}>{salesData.categoryCounts.QS || '-'}</td>
                      <td style={styles.td}>{salesData.categoryCounts.L || '-'}</td>
                      <td style={styles.td}>{salesData.categoryCounts.P || '-'}</td>
                      <td style={styles.td}>{salesData.categoryCounts.ES || '-'}</td>
                      {FISCAL_MONTHS.map(month => (
                        <td key={month} style={{...styles.td, fontSize: 11, maxWidth: 80}}>
                          {salesData.monthlyPurchases[month]?.join(',') || '-'}
                        </td>
                      ))}
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>
        </div>
      );
    }

    // ============================================
    // è£½å“åˆ¥è²©å£²ç©ç®—è¡¨ï¼ˆæ›¸é¡4ï¼‰
    // ============================================
    function ProductCount({ sales }) {
      const [selectedYear, setSelectedYear] = useState(getFiscalYear(new Date()));
      const [selectedCategory, setSelectedCategory] = useState('QS');

      const categories = {
        QS: { name: 'ã‚¯ã‚¤ãƒ¼ãƒ³ã‚·ãƒ«ãƒãƒ¼ï¼ˆã›ã£ã‘ã‚“ï¼‰', target: 120 },
        L: { name: 'ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³', target: 210 }
      };

      const getPurchasers = () => {
        const purchasers = [];
        const yearSales = sales.filter(s => getFiscalYear(new Date(s.date)) === selectedYear);

        yearSales.forEach(sale => {
          sale.items.forEach(item => {
            if (item.category === selectedCategory) {
              for (let i = 0; i < item.quantity; i++) {
                purchasers.push({
                  name: sale.customerName,
                  date: sale.date,
                  product: item.name
                });
              }
            }
          });
        });

        return purchasers;
      };

      const purchasers = getPurchasers();
      const target = categories[selectedCategory]?.target || 100;
      const progress = Math.min(100, (purchasers.length / target) * 100);

      const gridSize = target;
      const grid = Array.from({ length: gridSize }, (_, i) => purchasers[i] || null);

      const handlePrint = () => {
        const gridCells = grid.map((purchaser, index) => `
          <div class="count-cell ${purchaser ? 'filled' : ''}">
            <div class="num">${index + 1}</div>
            ${purchaser ? `<div class="name">${purchaser.name}</div>` : ''}
          </div>
        `).join('');

        const content = `
          <div class="print-header">
            <h1>è£½å“åˆ¥è²©å£²ç©ç®—è¡¨ï¼ˆæ›¸é¡4ï¼‰</h1>
            <div class="subtitle">${selectedYear}å¹´åº¦ï¼ˆ${selectedYear}å¹´3æœˆã€œ${selectedYear + 1}å¹´2æœˆï¼‰ã€€å‡ºåŠ›æ—¥: ${new Date().toLocaleDateString('ja-JP')}</div>
          </div>
          <div class="section">
            <div class="section-title">${categories[selectedCategory]?.name}</div>
            <div class="summary-grid" style="grid-template-columns: repeat(3, 1fr);">
              <div class="summary-item">
                <div class="label">ç›®æ¨™</div>
                <div class="value">${target}å€‹</div>
              </div>
              <div class="summary-item">
                <div class="label">å®Ÿç¸¾</div>
                <div class="value">${purchasers.length}å€‹</div>
              </div>
              <div class="summary-item">
                <div class="label">é”æˆç‡</div>
                <div class="value">${Math.round(progress)}%</div>
              </div>
            </div>
          </div>
          <div class="count-grid">
            ${gridCells}
          </div>
        `;
        printDocument(content, 'è£½å“åˆ¥è²©å£²ç©ç®—è¡¨', 'portrait');
      };

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>è£½å“åˆ¥è²©å£²ç©ç®—è¡¨ï¼ˆæ›¸é¡4ï¼‰</h1>

          <div style={styles.filterBar}>
            <div style={styles.filterGroup}>
              <label>å¹´åº¦:</label>
              <select 
                value={selectedYear} 
                onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                style={styles.filterSelect}
              >
                {[2024, 2025, 2026, 2027].map(year => (
                  <option key={year} value={year}>{year}å¹´åº¦</option>
                ))}
              </select>
            </div>
            <div style={styles.filterGroup}>
              <label>è£½å“:</label>
              <select 
                value={selectedCategory} 
                onChange={(e) => setSelectedCategory(e.target.value)}
                style={styles.filterSelect}
              >
                <option value="QS">ã‚¯ã‚¤ãƒ¼ãƒ³ã‚·ãƒ«ãƒãƒ¼ï¼ˆç›®æ¨™120å€‹ï¼‰</option>
                <option value="L">ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç›®æ¨™210å€‹ï¼‰</option>
              </select>
            </div>
            <button onClick={handlePrint} style={styles.printButton}>
              ğŸ“„ PDFå‡ºåŠ›ï¼ˆç¸¦ï¼‰
            </button>
          </div>

          <div style={styles.progressSection}>
            <div style={styles.progressHeader}>
              <span style={styles.progressTitle}>{categories[selectedCategory]?.name}</span>
              <span style={styles.progressCount}>{purchasers.length} / {target}å€‹</span>
            </div>
            <div style={styles.largeProgressBar}>
              <div style={{
                ...styles.progressFill,
                width: `${progress}%`,
                backgroundColor: selectedCategory === 'QS' ? '#10b981' : '#3b82f6'
              }}></div>
            </div>
            <div style={styles.progressPercent}>é”æˆç‡: {Math.round(progress)}%</div>
          </div>

          <div style={styles.countGrid}>
            {grid.map((purchaser, index) => (
              <div 
                key={index} 
                style={{
                  ...styles.countCell,
                  backgroundColor: purchaser ? (selectedCategory === 'QS' ? '#dcfce7' : '#dbeafe') : '#f9fafb',
                  borderColor: purchaser ? (selectedCategory === 'QS' ? '#10b981' : '#3b82f6') : '#e5e7eb'
                }}
                title={purchaser ? `${purchaser.name} (${purchaser.date})` : ''}
              >
                <span style={styles.cellNumber}>{index + 1}</span>
                {purchaser && (
                  <span style={styles.cellName}>{purchaser.name}</span>
                )}
              </div>
            ))}
          </div>
        </div>
      );
    }

    // ============================================
    // æœˆæœ«ãƒ¬ãƒãƒ¼ãƒˆå…¥åŠ›ï¼ˆæ›¸é¡1ï¼‰
    // ============================================
    function MonthlyReport({ customers, sales, monthlyReports, saveMonthlyReport }) {
      const currentDate = new Date();
      const [selectedYear, setSelectedYear] = useState(currentDate.getFullYear());
      const [selectedMonth, setSelectedMonth] = useState(currentDate.getMonth() + 1);

      const existingReport = monthlyReports.find(
        r => r.year === selectedYear && r.month === selectedMonth
      );

      const [report, setReport] = useState(existingReport || {
        year: selectedYear,
        month: selectedMonth,
        targetSales: 0,
        resultSales: 0,
        actions: {
          newCustomer: { target: 0, result: 0, amount: 0 },
          priceUp: { target: 0, result: 0, amount: 0 },
          jp: { target: 0, result: 0, amount: 0 },
          sample: { target: 0, result: 0 },
          monitor: { target: 0, result: 0 },
          expansion: { target: 0, result: 0 },
          repeat: { target: 0, result: 0 },
        },
        afterFollow: { total: 0, done: 0 },
        metCount: 0,
        threeStepSales: { qs: 0, pack: 0, lotion: 0 },
        purchase: 0,
        selfUse: 0
      });

      useEffect(() => {
        const existing = monthlyReports.find(
          r => r.year === selectedYear && r.month === selectedMonth
        );
        if (existing) {
          setReport(existing);
        } else {
          setReport({
            year: selectedYear,
            month: selectedMonth,
            targetSales: 0,
            resultSales: 0,
            actions: {
              newCustomer: { target: 0, result: 0, amount: 0 },
              priceUp: { target: 0, result: 0, amount: 0 },
              jp: { target: 0, result: 0, amount: 0 },
              sample: { target: 0, result: 0 },
              monitor: { target: 0, result: 0 },
              expansion: { target: 0, result: 0 },
              repeat: { target: 0, result: 0 },
            },
            afterFollow: { total: 0, done: 0 },
            metCount: 0,
            threeStepSales: { qs: 0, pack: 0, lotion: 0 },
            purchase: 0,
            selfUse: 0
          });
        }
      }, [selectedYear, selectedMonth, monthlyReports]);

      const autoCalculate = () => {
        const monthSales = sales.filter(s => {
          const d = new Date(s.date);
          return d.getFullYear() === selectedYear && d.getMonth() + 1 === selectedMonth;
        });

        let totalSales = 0;
        let qsCount = 0, packCount = 0, lotionCount = 0;

        monthSales.forEach(sale => {
          sale.items.forEach(item => {
            totalSales += item.price * item.quantity;
            if (item.category === 'QS') qsCount += item.quantity;
            if (item.category === 'P') packCount += item.quantity;
            if (item.category === 'L') lotionCount += item.quantity;
          });
        });

        setReport({
          ...report,
          resultSales: totalSales,
          threeStepSales: { qs: qsCount, pack: packCount, lotion: lotionCount }
        });
      };

      const handleSave = () => {
        saveMonthlyReport({
          ...report,
          year: selectedYear,
          month: selectedMonth
        });
      };

      const handlePrint = () => {
        const content = `
          <div class="print-header">
            <h1>æœˆæœ«ãƒ¬ãƒãƒ¼ãƒˆãƒ»æ°—ã¥ãï¼ˆæ›¸é¡1ï¼‰</h1>
            <div class="subtitle">${selectedYear}å¹´${selectedMonth}æœˆã€€å‡ºåŠ›æ—¥: ${new Date().toLocaleDateString('ja-JP')}</div>
          </div>
          
          <div class="section">
            <div class="section-title">â˜†ä»Šæœˆã®ç›®æ¨™å®Ÿå£²</div>
            <table>
              <tbody>
                <tr>
                  <th style="width:80px;">ç›®æ¨™</th>
                  <td style="width:120px;">Â¥${(report.targetSales || 0).toLocaleString()}</td>
                  <th style="width:80px;">çµæœ</th>
                  <td style="width:120px;">Â¥${(report.resultSales || 0).toLocaleString()}</td>
                  <th style="width:80px;">é”æˆç‡</th>
                  <td style="width:80px;">${report.targetSales ? Math.round((report.resultSales / report.targetSales) * 100) : 0}%</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="section">
            <div class="section-title">â˜†é¡§å®¢ãƒ©ãƒ³ã‚¯åˆ¥é›†è¨ˆ</div>
            <table>
              <thead>
                <tr>
                  <th>ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</th>
                  <th>Aãƒ©ãƒ³ã‚¯äººæ•°</th>
                  <th>Aãƒ©ãƒ³ã‚¯å£²ä¸Š</th>
                  <th>Bãƒ©ãƒ³ã‚¯äººæ•°</th>
                  <th>Bãƒ©ãƒ³ã‚¯å£²ä¸Š</th>
                  <th>Cãƒ©ãƒ³ã‚¯äººæ•°</th>
                  <th>Cãƒ©ãƒ³ã‚¯å£²ä¸Š</th>
                  <th>Dãƒ©ãƒ³ã‚¯äººæ•°</th>
                  <th>Dãƒ©ãƒ³ã‚¯å£²ä¸Š</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center">${customers.length}å</td>
                  <td class="text-center">${rankSummary.A.count}å</td>
                  <td class="text-right">Â¥${rankSummary.A.amount.toLocaleString()}</td>
                  <td class="text-center">${rankSummary.B.count}å</td>
                  <td class="text-right">Â¥${rankSummary.B.amount.toLocaleString()}</td>
                  <td class="text-center">${rankSummary.C.count}å</td>
                  <td class="text-right">Â¥${rankSummary.C.amount.toLocaleString()}</td>
                  <td class="text-center">${rankSummary.D.count}å</td>
                  <td class="text-right">Â¥${rankSummary.D.amount.toLocaleString()}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="section">
            <div class="section-title">â€»3ã‚¹ãƒ†ãƒƒãƒ—å®Ÿå£²æ•°</div>
            <table>
              <tbody>
                <tr>
                  <th style="width:120px;">QSï¼ˆã›ã£ã‘ã‚“ï¼‰</th>
                  <td style="width:80px;" class="text-center">${report.threeStepSales?.qs || 0}å€‹</td>
                  <th style="width:80px;">ãƒ‘ãƒƒã‚¯</th>
                  <td style="width:80px;" class="text-center">${report.threeStepSales?.pack || 0}æœ¬</td>
                  <th style="width:100px;">ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³</th>
                  <td style="width:80px;" class="text-center">${report.threeStepSales?.lotion || 0}æœ¬</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="section">
            <div class="section-title">â˜†ä»•å…¥ã‚Œãƒ»ä½¿ç”¨é‡‘é¡</div>
            <table>
              <tbody>
                <tr>
                  <th style="width:120px;">ä»•å…¥ã‚Œ</th>
                  <td style="width:150px;" class="text-right">Â¥${(report.purchase || 0).toLocaleString()}</td>
                  <th style="width:140px;">è‡ªåˆ†ã®ä½¿ç”¨é‡‘é¡</th>
                  <td style="width:150px;" class="text-right">Â¥${(report.selfUse || 0).toLocaleString()}</td>
                </tr>
              </tbody>
            </table>
          </div>
        `;
        printDocument(content, 'æœˆæœ«ãƒ¬ãƒãƒ¼ãƒˆ', 'portrait');
      };

      // ãƒ©ãƒ³ã‚¯åˆ¥é›†è¨ˆã‚’è¨ˆç®—
      const getRankSummary = () => {
        const monthSales = sales.filter(s => {
          const d = new Date(s.date);
          return d.getFullYear() === selectedYear && d.getMonth() + 1 === selectedMonth;
        });

        const rankData = { A: { count: 0, amount: 0 }, B: { count: 0, amount: 0 }, C: { count: 0, amount: 0 }, D: { count: 0, amount: 0 } };
        const customerSet = { A: new Set(), B: new Set(), C: new Set(), D: new Set() };

        monthSales.forEach(sale => {
          const customer = customers.find(c => c.name === sale.customerName);
          const rank = customer?.rank || 'C';
          sale.items.forEach(item => {
            if (rankData[rank]) {
              rankData[rank].amount += item.price * item.quantity;
              customerSet[rank].add(sale.customerName);
            }
          });
        });

        Object.keys(rankData).forEach(rank => {
          rankData[rank].count = customerSet[rank].size;
        });

        return rankData;
      };

      const rankSummary = getRankSummary();

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>æœˆæœ«ãƒ¬ãƒãƒ¼ãƒˆãƒ»æ°—ã¥ãï¼ˆæ›¸é¡1ï¼‰</h1>

          <div style={styles.filterBar}>
            <div style={styles.filterGroup}>
              <label>å¹´:</label>
              <select 
                value={selectedYear} 
                onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                style={styles.filterSelect}
              >
                {[2024, 2025, 2026, 2027].map(year => (
                  <option key={year} value={year}>{year}å¹´</option>
                ))}
              </select>
            </div>
            <div style={styles.filterGroup}>
              <label>æœˆ:</label>
              <select 
                value={selectedMonth} 
                onChange={(e) => setSelectedMonth(parseInt(e.target.value))}
                style={styles.filterSelect}
              >
                {FISCAL_MONTHS.map(month => (
                  <option key={month} value={month}>{month}æœˆ</option>
                ))}
              </select>
            </div>
            <button onClick={autoCalculate} style={styles.autoCalcButton}>
              å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªå‹•é›†è¨ˆ
            </button>
            <button onClick={handlePrint} style={styles.printButton}>
              ğŸ“„ PDFå‡ºåŠ›ï¼ˆç¸¦ï¼‰
            </button>
          </div>

          <div style={styles.reportForm}>
            <div style={styles.reportSection}>
              <h3 style={styles.reportSectionTitle}>â˜†ä»Šæœˆã®ç›®æ¨™å®Ÿå£²</h3>
              <div style={styles.reportRow}>
                <label>ç›®æ¨™:</label>
                <input
                  type="number"
                  value={report.targetSales}
                  onChange={(e) => setReport({...report, targetSales: parseInt(e.target.value) || 0})}
                  style={styles.reportInput}
                />
                <span>å††</span>
                <label style={{marginLeft: 20}}>çµæœ:</label>
                <input
                  type="number"
                  value={report.resultSales}
                  onChange={(e) => setReport({...report, resultSales: parseInt(e.target.value) || 0})}
                  style={styles.reportInput}
                />
                <span>å††</span>
              </div>
            </div>

            <div style={styles.reportSection}>
              <h3 style={styles.reportSectionTitle}>â€»3ã‚¹ãƒ†ãƒƒãƒ—å®Ÿå£²æ•°</h3>
              <div style={styles.reportRow}>
                <span>QS</span>
                <input
                  type="number"
                  value={report.threeStepSales?.qs || 0}
                  onChange={(e) => setReport({
                    ...report,
                    threeStepSales: { ...report.threeStepSales, qs: parseInt(e.target.value) || 0 }
                  })}
                  style={styles.smallInput}
                />
                <span>å€‹ ãƒ» ãƒ‘ãƒƒã‚¯</span>
                <input
                  type="number"
                  value={report.threeStepSales?.pack || 0}
                  onChange={(e) => setReport({
                    ...report,
                    threeStepSales: { ...report.threeStepSales, pack: parseInt(e.target.value) || 0 }
                  })}
                  style={styles.smallInput}
                />
                <span>æœ¬ ãƒ» ãƒ­ãƒ¼ã‚·ãƒ§ãƒ³</span>
                <input
                  type="number"
                  value={report.threeStepSales?.lotion || 0}
                  onChange={(e) => setReport({
                    ...report,
                    threeStepSales: { ...report.threeStepSales, lotion: parseInt(e.target.value) || 0 }
                  })}
                  style={styles.smallInput}
                />
                <span>æœ¬</span>
              </div>
            </div>

            <div style={styles.reportSection}>
              <div style={styles.reportRow}>
                <span>ä»•å…¥ã‚Œ:</span>
                <input
                  type="number"
                  value={report.purchase || 0}
                  onChange={(e) => setReport({...report, purchase: parseInt(e.target.value) || 0})}
                  style={styles.reportInput}
                />
                <span>å††</span>
                <span style={{marginLeft: 20}}>è‡ªåˆ†ã®ä½¿ç”¨é‡‘é¡:</span>
                <input
                  type="number"
                  value={report.selfUse || 0}
                  onChange={(e) => setReport({...report, selfUse: parseInt(e.target.value) || 0})}
                  style={styles.reportInput}
                />
                <span>å††</span>
              </div>
            </div>

            <button onClick={handleSave} style={styles.submitButton}>
              ãƒ¬ãƒãƒ¼ãƒˆã‚’ä¿å­˜
            </button>
          </div>
        </div>
      );
    }

    // ============================================
    // å¹´é–“ABCå ±å‘Šï¼ˆæ›¸é¡3ï¼‰
    // ============================================
    function YearlyReport({ monthlyReports, customers, sales }) {
      const [selectedYear, setSelectedYear] = useState(getFiscalYear(new Date()));

      const getYearlyData = () => {
        const data = [];
        
        FISCAL_MONTHS.forEach(month => {
          const year = month >= 3 ? selectedYear : selectedYear + 1;
          const report = monthlyReports.find(r => r.year === year && r.month === month);
          
          const monthSales = sales.filter(s => {
            const d = new Date(s.date);
            return d.getFullYear() === year && d.getMonth() + 1 === month;
          });

          const rankData = { A: { count: 0, amount: 0 }, B: { count: 0, amount: 0 }, C: { count: 0, amount: 0 }, D: { count: 0, amount: 0 } };
          const customerSet = { A: new Set(), B: new Set(), C: new Set(), D: new Set() };

          monthSales.forEach(sale => {
            const customer = customers.find(c => c.name === sale.customerName);
            const rank = customer?.rank || 'C';
            sale.items.forEach(item => {
              if (rankData[rank]) {
                rankData[rank].amount += item.price * item.quantity;
                customerSet[rank].add(sale.customerName);
              }
            });
          });

          Object.keys(rankData).forEach(rank => {
            rankData[rank].count = customerSet[rank].size;
          });

          data.push({
            month,
            year,
            report,
            rankData,
            totalCustomers: customers.length,
            totalSales: Object.values(rankData).reduce((sum, r) => sum + r.amount, 0)
          });
        });

        return data;
      };

      const yearlyData = getYearlyData();

      const handlePrint = () => {
        const rows = yearlyData.map(data => `
          <tr>
            <td class="text-center">${data.month}æœˆ</td>
            <td class="text-center">${data.totalCustomers}</td>
            <td class="text-center">${data.rankData.A.count}</td>
            <td class="text-right">Â¥${data.rankData.A.amount.toLocaleString()}</td>
            <td class="text-center">${data.rankData.B.count}</td>
            <td class="text-right">Â¥${data.rankData.B.amount.toLocaleString()}</td>
            <td class="text-center">${data.rankData.C.count}</td>
            <td class="text-right">Â¥${data.rankData.C.amount.toLocaleString()}</td>
            <td class="text-center">${data.rankData.D.count}</td>
            <td class="text-right">Â¥${data.rankData.D.amount.toLocaleString()}</td>
            <td class="text-right">Â¥${data.totalSales.toLocaleString()}</td>
            <td class="text-right">Â¥${(data.report?.purchase || 0).toLocaleString()}</td>
            <td class="text-right">Â¥${(data.report?.selfUse || 0).toLocaleString()}</td>
          </tr>
        `).join('');

        const content = `
          <div class="print-header">
            <h1>${selectedYear}å¹´åº¦ ABCå ±å‘Šï¼ˆæ›¸é¡3ï¼‰</h1>
            <div class="subtitle">${selectedYear}å¹´3æœˆã€œ${selectedYear + 1}å¹´2æœˆã€€å‡ºåŠ›æ—¥: ${new Date().toLocaleDateString('ja-JP')}</div>
          </div>
          <table>
            <thead>
              <tr>
                <th rowspan="2" style="width:45px;">æœˆ</th>
                <th rowspan="2" style="width:45px;">ç·æ•°</th>
                <th colspan="2">Aãƒ©ãƒ³ã‚¯</th>
                <th colspan="2">Bãƒ©ãƒ³ã‚¯</th>
                <th colspan="2">Cãƒ©ãƒ³ã‚¯</th>
                <th colspan="2">Dãƒ©ãƒ³ã‚¯</th>
                <th rowspan="2" style="width:80px;">å®Ÿå£²</th>
                <th rowspan="2" style="width:80px;">ä»•å…¥ã‚Œ</th>
                <th rowspan="2" style="width:80px;">ä½¿ç”¨é‡‘é¡</th>
              </tr>
              <tr>
                <th style="width:35px;">äºº</th>
                <th style="width:70px;">é‡‘é¡</th>
                <th style="width:35px;">äºº</th>
                <th style="width:70px;">é‡‘é¡</th>
                <th style="width:35px;">äºº</th>
                <th style="width:70px;">é‡‘é¡</th>
                <th style="width:35px;">äºº</th>
                <th style="width:70px;">é‡‘é¡</th>
              </tr>
            </thead>
            <tbody>
              ${rows}
            </tbody>
          </table>
        `;
        printDocument(content, 'å¹´é–“ABCå ±å‘Š', 'landscape');
      };

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>{selectedYear}å¹´åº¦ ABCå ±å‘Šï¼ˆæ›¸é¡3ï¼‰</h1>

          <div style={styles.filterBar}>
            <div style={styles.filterGroup}>
              <label>å¹´åº¦:</label>
              <select 
                value={selectedYear} 
                onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                style={styles.filterSelect}
              >
                {[2024, 2025, 2026, 2027].map(year => (
                  <option key={year} value={year}>{year}å¹´åº¦</option>
                ))}
              </select>
            </div>
            <button onClick={handlePrint} style={styles.printButton}>
              ğŸ“„ PDFå‡ºåŠ›ï¼ˆæ¨ªï¼‰
            </button>
          </div>

          <div style={styles.wideTableContainer}>
            <table style={styles.table}>
              <thead>
                <tr>
                  <th style={styles.th}>æœˆ</th>
                  <th style={styles.th}>ç·æ•°</th>
                  <th style={styles.th} colSpan="2">Aãƒ©ãƒ³ã‚¯</th>
                  <th style={styles.th} colSpan="2">Bãƒ©ãƒ³ã‚¯</th>
                  <th style={styles.th} colSpan="2">Cãƒ©ãƒ³ã‚¯</th>
                  <th style={styles.th} colSpan="2">Dãƒ©ãƒ³ã‚¯</th>
                  <th style={styles.th}>å®Ÿå£²</th>
                  <th style={styles.th}>ä»•å…¥ã‚Œ</th>
                  <th style={styles.th}>ä½¿ç”¨é‡‘é¡</th>
                </tr>
                <tr>
                  <th style={styles.thSub}></th>
                  <th style={styles.thSub}></th>
                  <th style={styles.thSub}>äºº</th>
                  <th style={styles.thSub}>é‡‘é¡</th>
                  <th style={styles.thSub}>äºº</th>
                  <th style={styles.thSub}>é‡‘é¡</th>
                  <th style={styles.thSub}>äºº</th>
                  <th style={styles.thSub}>é‡‘é¡</th>
                  <th style={styles.thSub}>äºº</th>
                  <th style={styles.thSub}>é‡‘é¡</th>
                  <th style={styles.thSub}></th>
                  <th style={styles.thSub}></th>
                  <th style={styles.thSub}></th>
                </tr>
              </thead>
              <tbody>
                {yearlyData.map((data, index) => (
                  <tr key={index}>
                    <td style={styles.td}>{data.month}æœˆ</td>
                    <td style={styles.td}>{data.totalCustomers}</td>
                    <td style={styles.td}>{data.rankData.A.count}</td>
                    <td style={styles.td}>{data.rankData.A.amount.toLocaleString()}</td>
                    <td style={styles.td}>{data.rankData.B.count}</td>
                    <td style={styles.td}>{data.rankData.B.amount.toLocaleString()}</td>
                    <td style={styles.td}>{data.rankData.C.count}</td>
                    <td style={styles.td}>{data.rankData.C.amount.toLocaleString()}</td>
                    <td style={styles.td}>{data.rankData.D.count}</td>
                    <td style={styles.td}>{data.rankData.D.amount.toLocaleString()}</td>
                    <td style={styles.td}>{data.totalSales.toLocaleString()}</td>
                    <td style={styles.td}>{data.report?.purchase?.toLocaleString() || 0}</td>
                    <td style={styles.td}>{data.report?.selfUse?.toLocaleString() || 0}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      );
    }

    // ============================================
    // ãƒã‚¹ã‚¿ç®¡ç†
    // ============================================
    function MasterManagement({ customers, addCustomer, updateCustomer, deleteCustomer, importCustomersFile, customProducts, addCustomProduct, deleteCustomProduct }) {
      const [activeTab, setActiveTab] = useState('customers');
      const [newCustomer, setNewCustomer] = useState({ name: '', rank: 'C' });
      const [newProduct, setNewProduct] = useState({
        categoryKey: 'skincare',
        code: '',
        name: '',
        price: '',
        category: 'other'
      });
      const fileInputRef = useRef(null);

      // ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®ç•¥ç§°é¸æŠè‚¢
      const categoryAbbrevOptions = {
        skincare: ['QS', 'L', 'P', 'ES', 'other'],
        baseMakeup: ['SP', 'MO', 'other'],
        hairBodyCare: ['other'],
        healthcare: ['é…µç´ ', 'other']
      };

      const handleAddCustomer = () => {
        if (!newCustomer.name) {
          alert('é¡§å®¢åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          return;
        }
        addCustomer(newCustomer);
        setNewCustomer({ name: '', rank: 'C' });
      };

      const handleFileUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          importCustomersFile(file);
        }
      };

      const handleAddProduct = () => {
        if (!newProduct.code) {
          alert('å•†å“ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          return;
        }
        if (!newProduct.name) {
          alert('å•†å“åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          return;
        }
        if (!newProduct.price || isNaN(parseInt(newProduct.price))) {
          alert('ä¾¡æ ¼ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„');
          return;
        }

        const success = addCustomProduct(newProduct.categoryKey, {
          code: newProduct.code,
          name: newProduct.name,
          price: parseInt(newProduct.price),
          category: newProduct.category
        });

        if (success) {
          setNewProduct({
            categoryKey: newProduct.categoryKey,
            code: '',
            name: '',
            price: '',
            category: 'other'
          });
        }
      };

      const handleCategoryKeyChange = (categoryKey) => {
        const defaultCategory = categoryAbbrevOptions[categoryKey]?.[categoryAbbrevOptions[categoryKey].length - 1] || 'other';
        setNewProduct({
          ...newProduct,
          categoryKey,
          category: defaultCategory
        });
      };

      // çµ„ã¿è¾¼ã¿è£½å“ã¨ã‚«ã‚¹ã‚¿ãƒ è£½å“ã‚’çµ±åˆã—ã¦è¡¨ç¤ºç”¨ãƒªã‚¹ãƒˆã‚’ä½œæˆ
      const getCombinedProducts = (categoryKey) => {
        const builtIn = PRODUCT_MASTER[categoryKey]?.products.map(p => ({ ...p, isCustom: false })) || [];
        const custom = customProducts[categoryKey]?.map(p => ({ ...p, isCustom: true })) || [];
        return [...builtIn, ...custom];
      };

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>ãƒã‚¹ã‚¿ç®¡ç†</h1>

          <div style={styles.tabs}>
            <button 
              style={{...styles.tab, ...(activeTab === 'customers' ? styles.tabActive : {})}}
              onClick={() => setActiveTab('customers')}
            >
              é¡§å®¢ãƒã‚¹ã‚¿
            </button>
            <button 
              style={{...styles.tab, ...(activeTab === 'products' ? styles.tabActive : {})}}
              onClick={() => setActiveTab('products')}
            >
              è£½å“ãƒã‚¹ã‚¿
            </button>
          </div>

          {activeTab === 'customers' && (
            <div>
              <div style={styles.addForm}>
                <h3>é¡§å®¢è¿½åŠ </h3>
                <div style={styles.addFormRow}>
                  <input
                    type="text"
                    placeholder="é¡§å®¢å"
                    value={newCustomer.name}
                    onChange={(e) => setNewCustomer({...newCustomer, name: e.target.value})}
                    style={styles.input}
                  />
                  <select
                    value={newCustomer.rank}
                    onChange={(e) => setNewCustomer({...newCustomer, rank: e.target.value})}
                    style={styles.rankSelect}
                  >
                    <option value="A">Aãƒ©ãƒ³ã‚¯</option>
                    <option value="B">Bãƒ©ãƒ³ã‚¯</option>
                    <option value="C">Cãƒ©ãƒ³ã‚¯</option>
                    <option value="D">Dãƒ©ãƒ³ã‚¯</option>
                  </select>
                  <button onClick={handleAddCustomer} style={styles.addButton}>è¿½åŠ </button>
                </div>
                <div style={styles.csvImport}>
                  <button 
                    onClick={() => fileInputRef.current?.click()} 
                    style={styles.importButton}
                  >
                    Excel/CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                  </button>
                  <input
                    ref={fileInputRef}
                    type="file"
                    accept=".xlsx,.xls,.csv"
                    onChange={handleFileUpload}
                    style={{ display: 'none' }}
                  />
                  <span style={styles.csvNote}>å½¢å¼: 1åˆ—ç›®=é¡§å®¢å, 2åˆ—ç›®=ãƒ©ãƒ³ã‚¯ï¼ˆA/B/C/Dï¼‰</span>
                </div>
              </div>

              <div style={styles.tableContainer}>
                <table style={styles.table}>
                  <thead>
                    <tr>
                      <th style={styles.th}>No</th>
                      <th style={styles.th}>é¡§å®¢å</th>
                      <th style={styles.th}>ãƒ©ãƒ³ã‚¯</th>
                      <th style={styles.th}>æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody>
                    {customers.map((customer, index) => (
                      <tr key={customer.id}>
                        <td style={styles.td}>{index + 1}</td>
                        <td style={styles.td}>{customer.name}</td>
                        <td style={styles.td}>
                          <select
                            value={customer.rank}
                            onChange={(e) => updateCustomer(customer.id, { rank: e.target.value })}
                            style={styles.inlineSelect}
                          >
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                          </select>
                        </td>
                        <td style={styles.td}>
                          <button
                            onClick={() => deleteCustomer(customer.id)}
                            style={styles.deleteButton}
                          >
                            å‰Šé™¤
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {activeTab === 'products' && (
            <div>
              <div style={styles.addForm}>
                <h3>è£½å“è¿½åŠ </h3>
                <div style={styles.productAddFormRow}>
                  <div style={styles.productFormGroup}>
                    <label style={styles.smallLabel}>ã‚«ãƒ†ã‚´ãƒª</label>
                    <select
                      value={newProduct.categoryKey}
                      onChange={(e) => handleCategoryKeyChange(e.target.value)}
                      style={styles.filterSelect}
                    >
                      <option value="skincare">ã‚¹ã‚­ãƒ³ã‚±ã‚¢</option>
                      <option value="baseMakeup">ãƒ™ãƒ¼ã‚¹ãƒ¡ã‚¤ã‚¯ã‚¢ãƒƒãƒ—</option>
                      <option value="hairBodyCare">ãƒ˜ã‚¢ã‚±ã‚¢&ãƒœãƒ‡ã‚£ã‚±ã‚¢</option>
                      <option value="healthcare">ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢</option>
                    </select>
                  </div>
                  <div style={styles.productFormGroup}>
                    <label style={styles.smallLabel}>å•†å“ã‚³ãƒ¼ãƒ‰</label>
                    <input
                      type="text"
                      placeholder="ä¾‹: 999001"
                      value={newProduct.code}
                      onChange={(e) => setNewProduct({...newProduct, code: e.target.value})}
                      style={{...styles.input, width: 120}}
                    />
                  </div>
                  <div style={styles.productFormGroup}>
                    <label style={styles.smallLabel}>ä¾¡æ ¼ï¼ˆç¨æŠœï¼‰</label>
                    <input
                      type="number"
                      placeholder="ä¾‹: 5000"
                      value={newProduct.price}
                      onChange={(e) => setNewProduct({...newProduct, price: e.target.value})}
                      style={{...styles.input, width: 100}}
                    />
                  </div>
                </div>
                <div style={{...styles.productAddFormRow, marginTop: 10}}>
                  <div style={{...styles.productFormGroup, flex: 1}}>
                    <label style={styles.smallLabel}>å•†å“å</label>
                    <input
                      type="text"
                      placeholder="å•†å“åã‚’å…¥åŠ›"
                      value={newProduct.name}
                      onChange={(e) => setNewProduct({...newProduct, name: e.target.value})}
                      style={styles.input}
                    />
                  </div>
                  <div style={styles.productFormGroup}>
                    <label style={styles.smallLabel}>ç•¥ç§°</label>
                    <select
                      value={newProduct.category}
                      onChange={(e) => setNewProduct({...newProduct, category: e.target.value})}
                      style={styles.filterSelect}
                    >
                      {categoryAbbrevOptions[newProduct.categoryKey]?.map(abbrev => (
                        <option key={abbrev} value={abbrev}>
                          {CATEGORY_ABBREV[abbrev] || abbrev}
                        </option>
                      ))}
                    </select>
                  </div>
                  <div style={{...styles.productFormGroup, alignSelf: 'flex-end'}}>
                    <button onClick={handleAddProduct} style={styles.addButton}>è¿½åŠ </button>
                  </div>
                </div>
              </div>

              {Object.entries(PRODUCT_MASTER).map(([key, category]) => {
                const combinedProducts = getCombinedProducts(key);
                const customCount = customProducts[key]?.length || 0;
                
                return (
                  <div key={key} style={styles.productCategory}>
                    <h3 style={styles.productCategoryTitle}>
                      {category.name}ï¼ˆç¨ç‡{category.taxRate}%ï¼‰
                      {customCount > 0 && (
                        <span style={styles.customCountBadge}>+{customCount}ä»¶è¿½åŠ </span>
                      )}
                    </h3>
                    <div style={styles.tableContainer}>
                      <table style={styles.table}>
                        <thead>
                          <tr>
                            <th style={styles.th}>å•†å“ã‚³ãƒ¼ãƒ‰</th>
                            <th style={styles.th}>å•†å“å</th>
                            <th style={styles.th}>ä¾¡æ ¼</th>
                            <th style={styles.th}>ç•¥ç§°</th>
                            <th style={{...styles.th, width: 60}}>æ“ä½œ</th>
                          </tr>
                        </thead>
                        <tbody>
                          {combinedProducts.map(product => (
                            <tr key={product.code + (product.isCustom ? '_custom' : '')}>
                              <td style={styles.td}>{product.code}</td>
                              <td style={styles.td}>
                                {product.isCustom && <span style={styles.customBadge}>â˜…</span>}
                                {product.name}
                              </td>
                              <td style={styles.td}>Â¥{product.price.toLocaleString()}</td>
                              <td style={styles.td}>{CATEGORY_ABBREV[product.category] || product.category}</td>
                              <td style={styles.td}>
                                {product.isCustom ? (
                                  <button
                                    onClick={() => deleteCustomProduct(key, product.id)}
                                    style={styles.deleteButton}
                                  >
                                    å‰Šé™¤
                                  </button>
                                ) : (
                                  <span style={styles.builtInLabel}>çµ„è¾¼</span>
                                )}
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      );
    }

    // ============================================
    // ãƒ‡ãƒ¼ã‚¿ç®¡ç†ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰
    // ============================================
    function BackupManagement({ exportBackup, importBackup }) {
      const fileInputRef = useRef(null);

      const handleFileUpload = (e) => {
        const file = e.target.files[0];
        if (file) {
          if (confirm('ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã—ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ')) {
            importBackup(file);
          }
        }
      };

      return (
        <div style={styles.viewContainer}>
          <h1 style={styles.viewTitle}>ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h1>

          <div style={styles.backupSection}>
            <div style={styles.backupCard}>
              <div style={styles.backupIcon}>ğŸ’¾</div>
              <h3>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ</h3>
              <p>ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</p>
              <button onClick={exportBackup} style={styles.submitButton}>
                ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
              </button>
            </div>

            <div style={styles.backupCard}>
              <div style={styles.backupIcon}>ğŸ“‚</div>
              <h3>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©å…ƒ</h3>
              <p>ä¿å­˜ã—ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã—ã¾ã™ã€‚</p>
              <button 
                onClick={() => fileInputRef.current?.click()} 
                style={styles.importButton}
              >
                ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦å¾©å…ƒ
              </button>
              <input
                ref={fileInputRef}
                type="file"
                accept=".json"
                onChange={handleFileUpload}
                style={{ display: 'none' }}
              />
            </div>
          </div>

          <div style={styles.backupNote}>
            <h4>ğŸ’¡ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ãƒ’ãƒ³ãƒˆ</h4>
            <ul>
              <li>æœˆæœ«ä½œæ¥­å¾Œã¯å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–å¾—ã—ã¦ãã ã•ã„</li>
              <li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆGoogle Driveç­‰ï¼‰ã«ä¿å­˜ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™</li>
              <li>PCã®è²·ã„æ›¿ãˆæ™‚ã¯ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°ã—ã„PCã§å¾©å…ƒã§ãã¾ã™</li>
            </ul>
          </div>
        </div>
      );
    }

    // ============================================
    // ã‚¹ã‚¿ã‚¤ãƒ«å®šç¾©
    // ============================================
    const styles = {
      container: {
        display: 'flex',
        minHeight: '100vh',
        backgroundColor: '#f5f5f5',
        fontFamily: '"Noto Sans JP", "Hiragino Sans", "Meiryo", sans-serif',
      },
      sidebar: {
        width: 220,
        backgroundColor: '#1a1a2e',
        color: '#fff',
        padding: '20px 0',
        display: 'flex',
        flexDirection: 'column',
        position: 'fixed',
        height: '100vh',
        overflowY: 'auto',
      },
      logo: {
        display: 'flex',
        alignItems: 'center',
        padding: '0 20px 20px',
        borderBottom: '1px solid #333',
        marginBottom: 20,
      },
      logoIcon: { fontSize: 28, marginRight: 10 },
      logoText: { fontSize: 18, fontWeight: 'bold' },
      nav: { flex: 1 },
      navItem: {
        display: 'flex',
        alignItems: 'center',
        width: '100%',
        padding: '12px 20px',
        border: 'none',
        backgroundColor: 'transparent',
        color: '#aaa',
        cursor: 'pointer',
        fontSize: 14,
        textAlign: 'left',
        transition: 'all 0.2s',
      },
      navItemActive: {
        backgroundColor: '#16213e',
        color: '#fff',
        borderLeft: '3px solid #e94560',
      },
      navIcon: { marginRight: 10, fontSize: 16 },
      navLabel: { flex: 1 },
      fiscalYear: {
        padding: '15px 20px',
        fontSize: 12,
        color: '#888',
        borderTop: '1px solid #333',
      },
      main: { flex: 1, marginLeft: 220, padding: 30 },
      notification: {
        position: 'fixed',
        top: 20,
        right: 20,
        padding: '12px 24px',
        borderRadius: 8,
        fontWeight: 'bold',
        zIndex: 1000,
        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
      },
      viewContainer: { maxWidth: 1400, margin: '0 auto' },
      viewTitle: { fontSize: 24, fontWeight: 'bold', marginBottom: 24, color: '#1a1a2e' },
      cardGrid: {
        display: 'grid',
        gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))',
        gap: 20,
        marginBottom: 30,
      },
      card: {
        backgroundColor: '#fff',
        borderRadius: 12,
        padding: 24,
        boxShadow: '0 2px 8px rgba(0,0,0,0.08)',
      },
      cardHeader: { display: 'flex', alignItems: 'center', gap: 8, fontSize: 14, color: '#666', marginBottom: 12 },
      cardIcon: { fontSize: 20 },
      cardValue: { fontSize: 32, fontWeight: 'bold', color: '#1a1a2e' },
      cardSub: { fontSize: 13, color: '#888', marginTop: 8 },
      progressBar: { height: 8, backgroundColor: '#e5e7eb', borderRadius: 4, marginTop: 12, overflow: 'hidden' },
      progressFill: { height: '100%', backgroundColor: '#10b981', borderRadius: 4, transition: 'width 0.3s ease' },
      section: { backgroundColor: '#fff', borderRadius: 12, padding: 24, boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      sectionTitle: { fontSize: 18, fontWeight: 'bold', marginBottom: 16, color: '#1a1a2e' },
      tableContainer: { overflowX: 'auto' },
      wideTableContainer: { overflowX: 'auto', maxWidth: '100%' },
      table: { width: '100%', borderCollapse: 'collapse', fontSize: 14 },
      th: { backgroundColor: '#f8f9fa', padding: '12px 8px', textAlign: 'left', fontWeight: 'bold', borderBottom: '2px solid #e5e7eb', whiteSpace: 'nowrap' },
      thSub: { backgroundColor: '#f8f9fa', padding: '8px', textAlign: 'left', fontSize: 11, borderBottom: '2px solid #e5e7eb' },
      td: { padding: '10px 8px', borderBottom: '1px solid #e5e7eb' },
      inlineSelect: { padding: '4px 8px', border: '1px solid #ddd', borderRadius: 4, backgroundColor: '#fff', cursor: 'pointer' },
      stepIndicator: { display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: 40 },
      step: { display: 'flex', alignItems: 'center', gap: 8, color: '#aaa' },
      stepActive: { color: '#e94560', fontWeight: 'bold' },
      stepNumber: { width: 28, height: 28, borderRadius: '50%', backgroundColor: '#e5e7eb', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 14 },
      stepLine: { width: 60, height: 2, backgroundColor: '#e5e7eb', margin: '0 10px' },
      uploadSection: { textAlign: 'center', maxWidth: 500, margin: '0 auto' },
      uploadArea: { border: '3px dashed #ddd', borderRadius: 16, padding: 60, cursor: 'pointer', backgroundColor: '#fafafa', transition: 'all 0.2s' },
      uploadIcon: { fontSize: 64, marginBottom: 16 },
      uploadText: { fontSize: 18, color: '#333', marginBottom: 8 },
      uploadSubtext: { fontSize: 14, color: '#888' },
      processing: { textAlign: 'center' },
      spinner: { width: 40, height: 40, border: '4px solid #e5e7eb', borderTop: '4px solid #e94560', borderRadius: '50%', margin: '0 auto 16px', animation: 'spin 1s linear infinite' },
      orDivider: { margin: '30px 0', color: '#888', position: 'relative' },
      manualButton: { padding: '12px 32px', backgroundColor: '#fff', border: '2px solid #1a1a2e', borderRadius: 8, color: '#1a1a2e', fontSize: 16, cursor: 'pointer', transition: 'all 0.2s' },
      formSection: { backgroundColor: '#fff', borderRadius: 12, padding: 24, boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      formGrid: { display: 'grid', gap: 30 },
      imagePreview: { backgroundColor: '#f8f9fa', borderRadius: 8, padding: 16 },
      previewTitle: { fontSize: 14, marginBottom: 12, color: '#666' },
      previewImage: { maxWidth: '100%', borderRadius: 8, boxShadow: '0 2px 8px rgba(0,0,0,0.1)' },
      formPanel: { padding: '0 16px' },
      formTitle: { fontSize: 18, marginBottom: 20, color: '#1a1a2e' },
      formGroup: { marginBottom: 20 },
      label: { display: 'block', fontSize: 14, fontWeight: 'bold', marginBottom: 8, color: '#333' },
      input: { width: '100%', padding: '10px 12px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14, boxSizing: 'border-box' },
      customerInputGroup: { display: 'flex', gap: 10 },
      newCustomerNote: { display: 'flex', alignItems: 'center', gap: 10, marginTop: 8 },
      newBadge: { backgroundColor: '#fef3c7', color: '#d97706', padding: '4px 8px', borderRadius: 4, fontSize: 12, fontWeight: 'bold' },
      rankSelect: { padding: '6px 12px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14 },
      itemRow: { display: 'flex', alignItems: 'center', gap: 10, marginBottom: 10 },
      productSelect: { flex: 1, padding: '10px 12px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14 },
      quantityInput: { width: 60, padding: '10px 8px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14, textAlign: 'center' },
      itemPrice: { width: 80, textAlign: 'right', fontWeight: 'bold' },
      removeButton: { width: 32, height: 32, border: 'none', backgroundColor: '#fee2e2', color: '#dc2626', borderRadius: 6, cursor: 'pointer', fontSize: 14 },
      addItemButton: { padding: '8px 16px', backgroundColor: '#f0f9ff', border: '1px dashed #3b82f6', borderRadius: 6, color: '#3b82f6', cursor: 'pointer', fontSize: 14 },
      totalSection: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px 0', borderTop: '2px solid #e5e7eb', marginTop: 20 },
      totalAmount: { fontSize: 24, fontWeight: 'bold', color: '#1a1a2e' },
      buttonGroup: { display: 'flex', gap: 12, marginTop: 24 },
      cancelButton: { flex: 1, padding: '12px 24px', backgroundColor: '#f3f4f6', border: 'none', borderRadius: 8, color: '#666', fontSize: 16, cursor: 'pointer' },
      submitButton: { flex: 1, padding: '12px 24px', backgroundColor: '#e94560', border: 'none', borderRadius: 8, color: '#fff', fontSize: 16, fontWeight: 'bold', cursor: 'pointer' },
      completionSection: { textAlign: 'center', padding: 60 },
      completionIcon: { fontSize: 64, marginBottom: 20 },
      completionTitle: { fontSize: 24, fontWeight: 'bold', marginBottom: 16, color: '#1a1a2e' },
      completionText: { color: '#666', marginBottom: 30, lineHeight: 1.8 },
      filterBar: { display: 'flex', gap: 20, marginBottom: 24, flexWrap: 'wrap', alignItems: 'center' },
      filterGroup: { display: 'flex', alignItems: 'center', gap: 8 },
      filterSelect: { padding: '8px 12px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14 },
      searchInput: { padding: '8px 12px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14, width: 200 },
      autoCalcButton: { padding: '8px 16px', backgroundColor: '#3b82f6', border: 'none', borderRadius: 6, color: '#fff', fontSize: 14, cursor: 'pointer' },
      printButton: { padding: '8px 16px', backgroundColor: '#059669', border: 'none', borderRadius: 6, color: '#fff', fontSize: 14, cursor: 'pointer', marginLeft: 'auto' },
      progressSection: { backgroundColor: '#fff', borderRadius: 12, padding: 24, marginBottom: 24, boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      progressHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 },
      progressTitle: { fontSize: 18, fontWeight: 'bold' },
      progressCount: { fontSize: 24, fontWeight: 'bold', color: '#1a1a2e' },
      largeProgressBar: { height: 20, backgroundColor: '#e5e7eb', borderRadius: 10, overflow: 'hidden' },
      progressPercent: { textAlign: 'right', marginTop: 8, color: '#666', fontSize: 14 },
      countGrid: { display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(80px, 1fr))', gap: 8, backgroundColor: '#fff', borderRadius: 12, padding: 20, boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      countCell: { aspectRatio: '1', border: '1px solid #e5e7eb', borderRadius: 8, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', fontSize: 10, padding: 4, textAlign: 'center' },
      cellNumber: { fontWeight: 'bold', color: '#888' },
      cellName: { fontSize: 9, marginTop: 2, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap', maxWidth: '100%' },
      reportForm: { backgroundColor: '#fff', borderRadius: 12, padding: 24, boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      reportSection: { marginBottom: 24, paddingBottom: 20, borderBottom: '1px solid #e5e7eb' },
      reportSectionTitle: { fontSize: 16, fontWeight: 'bold', marginBottom: 16, color: '#1a1a2e' },
      reportRow: { display: 'flex', alignItems: 'center', gap: 10, flexWrap: 'wrap' },
      reportInput: { width: 120, padding: '8px 12px', border: '1px solid #ddd', borderRadius: 6, fontSize: 14 },
      smallInput: { width: 60, padding: '6px 8px', border: '1px solid #ddd', borderRadius: 4, fontSize: 14, textAlign: 'center' },
      tabs: { display: 'flex', gap: 4, marginBottom: 24 },
      tab: { padding: '12px 24px', border: 'none', backgroundColor: '#e5e7eb', borderRadius: '8px 8px 0 0', cursor: 'pointer', fontSize: 14, color: '#666' },
      tabActive: { backgroundColor: '#fff', color: '#1a1a2e', fontWeight: 'bold' },
      addForm: { backgroundColor: '#f8f9fa', borderRadius: 8, padding: 20, marginBottom: 24 },
      addFormRow: { display: 'flex', gap: 12, marginTop: 12 },
      addButton: { padding: '10px 24px', backgroundColor: '#10b981', border: 'none', borderRadius: 6, color: '#fff', fontSize: 14, cursor: 'pointer' },
      csvImport: { display: 'flex', alignItems: 'center', gap: 12, marginTop: 16 },
      importButton: { padding: '10px 20px', backgroundColor: '#3b82f6', border: 'none', borderRadius: 6, color: '#fff', fontSize: 14, cursor: 'pointer' },
      csvNote: { fontSize: 12, color: '#888' },
      deleteButton: { padding: '4px 12px', backgroundColor: '#fee2e2', border: '1px solid #fecaca', borderRadius: 4, color: '#dc2626', fontSize: 12, cursor: 'pointer' },
      note: { color: '#666', marginBottom: 20 },
      productCategory: { marginBottom: 30 },
      productCategoryTitle: { fontSize: 16, fontWeight: 'bold', marginBottom: 12, color: '#1a1a2e' },
      backupSection: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: 24, marginBottom: 30 },
      backupCard: { backgroundColor: '#fff', borderRadius: 12, padding: 30, textAlign: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      backupIcon: { fontSize: 48, marginBottom: 16 },
      backupNote: { backgroundColor: '#fef3c7', borderRadius: 12, padding: 24 },
      // è£½å“è¿½åŠ æ©Ÿèƒ½ç”¨ã‚¹ã‚¿ã‚¤ãƒ«
      productAddFormRow: { display: 'flex', gap: 12, alignItems: 'flex-end', flexWrap: 'wrap' },
      productFormGroup: { display: 'flex', flexDirection: 'column', gap: 4 },
      smallLabel: { fontSize: 12, color: '#666', fontWeight: '500' },
      customCountBadge: { marginLeft: 10, fontSize: 12, backgroundColor: '#dbeafe', color: '#1d4ed8', padding: '2px 8px', borderRadius: 10, fontWeight: 'normal' },
      customBadge: { color: '#f59e0b', marginRight: 4 },
      builtInLabel: { fontSize: 11, color: '#9ca3af', padding: '2px 6px', backgroundColor: '#f3f4f6', borderRadius: 3 },
      // å£²ä¸Šå±¥æ­´æ©Ÿèƒ½ç”¨ã‚¹ã‚¿ã‚¤ãƒ«
      editModeBadge: { marginLeft: 12, fontSize: 14, backgroundColor: '#fef3c7', color: '#d97706', padding: '4px 12px', borderRadius: 6, fontWeight: 'normal' },
      editModeHeader: { backgroundColor: '#fef3c7', color: '#92400e', padding: '12px 16px', borderRadius: 8, marginBottom: 20, fontSize: 14 },
      historySection: { marginTop: 40, backgroundColor: '#fff', borderRadius: 12, padding: 24, boxShadow: '0 2px 8px rgba(0,0,0,0.08)' },
      historyHeader: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 16 },
      historySectionTitle: { fontSize: 18, fontWeight: 'bold', color: '#1a1a2e', margin: 0 },
      historyCount: { fontSize: 13, color: '#666' },
      actionButtons: { display: 'flex', gap: 8 },
      editButton: { padding: '6px 10px', backgroundColor: '#dbeafe', border: 'none', borderRadius: 6, cursor: 'pointer', fontSize: 14 },
      deleteButtonSmall: { padding: '6px 10px', backgroundColor: '#fee2e2', border: 'none', borderRadius: 6, cursor: 'pointer', fontSize: 14 },
      editingRow: { backgroundColor: '#fef9c3' },
      noHistory: { textAlign: 'center', padding: '40px 20px', color: '#888' },
      monthEndSection: { marginTop: 24, padding: 20, backgroundColor: '#fef3c7', borderRadius: 12, display: 'flex', justifyContent: 'space-between', alignItems: 'center', flexWrap: 'wrap', gap: 16 },
      monthEndWarning: { flex: 1 },
      monthEndNote: { fontSize: 12, color: '#92400e', marginTop: 4 },
      clearHistoryButton: { padding: '12px 24px', backgroundColor: '#f59e0b', border: 'none', borderRadius: 8, color: '#fff', fontSize: 14, fontWeight: 'bold', cursor: 'pointer', whiteSpace: 'nowrap' },
    };

    // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    ReactDOM.render(<CosmeticsSalesApp />, document.getElementById('root'));
  </script>
</body>
</html>
